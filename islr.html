<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeffrey Long">

<title>Introduction to Statistcal Learing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="islr_files/libs/clipboard/clipboard.min.js"></script>
<script src="islr_files/libs/quarto-html/quarto.js"></script>
<script src="islr_files/libs/quarto-html/popper.min.js"></script>
<script src="islr_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="islr_files/libs/quarto-html/anchor.min.js"></script>
<link href="islr_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="islr_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="islr_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="islr_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="islr_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Statistcal Learing</h1>
<p class="subtitle lead">with Applications in R (ISLR) abstracted to Biomarker Discovery and Prediction</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jeffrey Long </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="a-quarto-experiment" class="level2">
<h2 class="anchored" data-anchor-id="a-quarto-experiment">A Quarto Experiment</h2>
<p>Quarto enables you to weave together content and executable code into a finished document.</p>
<p>ISLR second edition is available for the author in <a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">a free pdf format</a>.</p>
<p>This is my biomarker experiment with Quarto and ISLR.</p>
</section>
<section id="history" class="level2">
<h2 class="anchored" data-anchor-id="history">History</h2>
<p>The Elements of Statistical Learning (ESL, by Hastie, Tibshirani, and Friedman) — was published in 2001. The authors of ISLR2 (the resource of this experiment) are Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani.</p>
</section>
<section id="contents" class="level2">
<h2 class="anchored" data-anchor-id="contents">Contents</h2>
<ol type="1">
<li>Introduction</li>
<li>Statistical Learning</li>
<li>Linear Regression</li>
<li>Classification</li>
<li>Resampling Methods</li>
<li>Linear Model Selection and Regularization</li>
<li>Moving Beyond Linearity</li>
<li>Tree-Based Methods</li>
<li>Support Vector Machines</li>
<li>Deep Learning</li>
<li>Survival Analysis and Censored Data</li>
<li>Unsupervised Learning</li>
<li>Multiple Testing</li>
</ol>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Statistical learning refers to a vast set of tools for understanding data. These tools can be classified as supervised or unsupervised. Broadly speaking, supervised statistical learning involves building a statistical model for pre- dicting, or estimating, an output based on one or more inputs. Problems of this nature occur in fields as diverse as business, medicine, astrophysics, and public policy. With unsupervised statistical learning, there are inputs but no supervising output; nevertheless we can learn relationships and struc- ture from such data.</p>
<p><strong>The <code>Wage</code> data</strong> involves predicting a continuous or quantitative output value. This is often referred to as a regression problem. However, in certain cases we may instead wish to predict a non-numerical value—that is, a categorical or qualitative output.</p>
<p>An example of predicting non-numerical values, such as up/down is explored with <strong>the <code>Smarket</code> data</strong> are the Standard &amp; Poor’s 500 (S&amp;P) stock index over a 5-year period between 2001 and 2005.</p>
<p>Imagine the first steps of a search for biomarkers in gene expression data. We might have demographic information for a number of patients with an indication. We may wish to understand which types of patients are similar to each other by grouping individuals according to observed characteristics. This is a <em>clustering</em> problem. Unlike <code>Wage</code> and <code>Smarket</code> data, here we are not trying to predict an output variable. We will use <strong>the NCI60 data set</strong> to determine groups or clusters based on 6,830 gene expression measurements for 64 cell lines.</p>
<p>In this particular data set, it turns out that the cell lines correspond to 14 different types of cancer. There is clear evidence that cell lines with the same cancer type tend to be located near each other in clustering methods.</p>
<p>We will use <em>n</em> to represent the number of distinct data points, or observations, in our sample. We will let <em>p</em> denote the number of variables that are available for use in making predictions. For example, the <code>Wage</code> data set consists of 11 variables for 3,000 people, so we have <em>n</em> = 3,000 observations and <em>p</em> = 11 variables (such as year, age, race, and more). We indicate variable names using the font: <code>Variable Name</code>.</p>
<p>We will let <span class="math inline">\(x_{ij}\)</span> represent the value of the <em>j</em>th variable for the <em>i</em>th observation, where <em>i</em> = 1,2,…,<em>n</em> and <em>j</em> = 1,2,…,<em>p</em>. Throughout this experiment, <em>i</em> will be used to index the samples or observations (from 1 to <em>n</em>) and j will be used to index the variables (from 1 to <em>p</em>). We let <span class="math inline">\(\chi\)</span> denote an <span class="math inline">\(n × p\)</span> matrix whose (<em>i</em>, <em>j</em>)th element is <span class="math inline">\(x_{ij}\)</span> .</p>
<p>The product of <strong>A</strong> and <strong>B</strong> is denoted <strong>AB</strong>. The (<em>i</em>,<em>j</em>)th element of <strong>AB</strong> is computed by multiplying each element of the <em>i</em>th row of <strong>A</strong> by the corresponding element of the <em>j</em>th column of <strong>B</strong>. That is, <span class="math inline">\((AB)_{ij} = \Sigma^d_{k=1} a_{ik}b_{kj}\)</span>. As an example,</p>
<p>consider <span class="math inline">\(A = \begin{pmatrix}1 &amp; 2\\3 &amp; 4\end{pmatrix}\)</span> and <span class="math inline">\(B = \begin{pmatrix}5 &amp; 6\\7 &amp; 8\end{pmatrix}\)</span> .</p>
<p><span class="math inline">\(AB = \begin{pmatrix}1 &amp; 2\\3 &amp; 4\end{pmatrix}\begin{pmatrix}5 &amp; 6\\7 &amp; 8\end{pmatrix} = \begin{pmatrix}1*5+2*7 &amp; 1*6+2*8\\3*5+4*7 &amp; 3*6+4*8\end{pmatrix} = \begin{pmatrix}19 &amp; 22\\43 &amp; 50\end{pmatrix}\)</span></p>
<p>Note that this operation produces an <span class="math inline">\(r × s\)</span> matrix. It is only possible to compute <strong>AB</strong> if the number of columns of <strong>A</strong> is the same as the number of rows of <strong>B</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ISLR2")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">packageDescription</span>(<span class="st">"ISLR2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Package: ISLR2
Version: 1.3-1
Date: 2022-01-10
Title: Introduction to Statistical Learning, Second Edition
Authors@R: c(person("Gareth", "James", role="aut"), person("Daniela",
        "Witten", role="aut"), person("Trevor", "Hastie", role=c("aut",
        "cre"), email = "hastie@stanford.edu"), person("Rob",
        "Tibshirani", role="aut"), person("Balasubramanian",
        "Narasimhan", role="ctb"))
Suggests: MASS
Description: We provide the collection of data-sets used in the book
        'An Introduction to Statistical Learning with Applications in
        R, Second Edition'. These include many data-sets that we used
        in the first edition (some with minor changes), and some new
        datasets.
Depends: R (&gt;= 3.5.0)
License: GPL-2
LazyLoad: yes
LazyData: yes
URL: https://www.statlearning.com
NeedsCompilation: no
Packaged: 2022-01-10 16:06:23 UTC; hastie
Author: Gareth James [aut], Daniela Witten [aut], Trevor Hastie [aut,
        cre], Rob Tibshirani [aut], Balasubramanian Narasimhan [ctb]
Maintainer: Trevor Hastie &lt;hastie@stanford.edu&gt;
Repository: CRAN
Date/Publication: 2022-01-10 16:22:42 UTC
Built: R 4.1.1; ; 2022-01-10 16:34:33 UTC; unix

-- File: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/ISLR2/Meta/package.rds </code></pre>
</div>
</div>
<p>The website for ISLR2 is <a href="https://www.statlearning.com/">www.statlearning.com</a>.</p>
</section>
<section id="statistical-learning" class="level2">
<h2 class="anchored" data-anchor-id="statistical-learning">Statistical Learning</h2>
<p>The input variables are typically denoted using the symbol X, with a subscript to distinguish them. The inputs go by different names, such as predictors, independent variables, features, or sometimes just variables, and is typically denoted using the symbol Y.</p>
<p>Suppose that we observe a quantitative response Y and p different predictors, X1, X2, … , Xp. We assume that there is some relationship between Y and X = (X1,X2,…,Xp), which can be written in the very general form</p>
<p><span class="math inline">\(Y =f(X)+\epsilon\)</span>.</p>
<p>Here f is some fixed but unknown function of <span class="math inline">\(X_1, \hdots, X_p\)</span> , and <span class="math inline">\(\epsilon\)</span> is a random error term, which is independent of <span class="math inline">\(X\)</span> and has mean zero. In this formulation, <span class="math inline">\(f\)</span> represents the systematic information that <span class="math inline">\(X\)</span> provides about <span class="math inline">\(Y\)</span> . However, the function <span class="math inline">\(f\)</span> that connects the input variable to the output variable is in general unknown. In this situation one must estimate <span class="math inline">\(f\)</span> based on the observed points. Overall, the errors have approximately mean zero. The function <span class="math inline">\(f\)</span> may involve more than one input variable.</p>
<section id="why-estimate-f" class="level3">
<h3 class="anchored" data-anchor-id="why-estimate-f">Why Estimate f?</h3>
<p>There are two main reasons that we may wish to estimate f: prediction and inference. We discuss each in turn.</p>
<section id="prediction" class="level4">
<h4 class="anchored" data-anchor-id="prediction">Prediction</h4>
<p>In many situations, a set of inputs <span class="math inline">\(X\)</span> are readily available, but the output <span class="math inline">\(Y\)</span> cannot be easily obtained. In this setting, since the error term averages to zero, we can predict <span class="math inline">\(Y\)</span> using</p>
<p><span class="math inline">\(\hat{Y} = f(X)\)</span> ,</p>
<p>where <span class="math inline">\(\hat{f}\)</span> represents our estimate for <span class="math inline">\(f\)</span> , and <span class="math inline">\(\hat{Y}\)</span> represents the resulting prediction for <span class="math inline">\(Y\)</span> . In this setting, <span class="math inline">\(\hat{f}\)</span> is often treated as a <em>black box</em>, in the sense that one is not typically concerned with the exact form of <span class="math inline">\(\hat{f}\)</span> , provided that it yields accurate predictions for <span class="math inline">\(Y\)</span> .</p>
<p>The accuracy of <span class="math inline">\(\hat{Y}\)</span> as a prediction for <span class="math inline">\(Y\)</span> depends on two quantities, which we will call the <em>reducible error</em> and the <em>irreducible error</em>. In general, <span class="math inline">\(\hat{f}\)</span> will not be a perfect estimate for $f$, and this inaccuracy will introduce some error. This error is reducible because we can potentially improve the accuracy of <span class="math inline">\(\hat{f}\)</span> by using the most appropriate statistical learning technique to estimate <span class="math inline">\(f\)</span> . However, even if it were possible to form a perfect estimate for <span class="math inline">\(f\)</span> , so that our estimated response took the form <span class="math inline">\(\hat{Y} = f(X)\)</span> , our prediction would still have some error in it! This is because <span class="math inline">\(Y\)</span> is also a function of <span class="math inline">\(\epsilon\)</span> , which, by definition, cannot be predicted using <span class="math inline">\(X\)</span> . Therefore, variability associated with <span class="math inline">\(\epsilon\)</span> also affects the accuracy of our predictions. This is known as the irreducible error, because no matter how well we estimate <span class="math inline">\(f\)</span> , we cannot reduce the error introduced by <span class="math inline">\(\epsilon\)</span> .</p>
</section>
<section id="inference" class="level4">
<h4 class="anchored" data-anchor-id="inference">Inference</h4>
<p>We are often interested in understanding the association between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1,...,X_p\)</span> . In this situation we wish to estimate <span class="math inline">\(f\)</span> , but our goal is not necessarily to make predictions for <span class="math inline">\(Y\)</span> . Now <span class="math inline">\(\hat{f}\)</span> cannot be treated as a black box, because we need to know its exact form. In this setting, one may be interested in answering the following questions:</p>
<p>• Which predictors are associated with the response? It is often the case that only a small fraction of the available predictors are substantially associated with <span class="math inline">\(Y\)</span> . Identifying the few important predictors among a large set of possible variables can be extremely useful, depending on the application.</p>
<p>• What is the relationship between the response and each predictor? Some predictors may have a positive relationship with <span class="math inline">\(Y\)</span> , in the sense that larger values of the predictor are associated with larger values of <span class="math inline">\(Y\)</span> . Other predictors may have the opposite relationship. Depending on the complexity of <span class="math inline">\(f\)</span> , the relationship between the response and a given predictor may also depend on the values of the other predictors.</p>
<p>• Can the relationship between <span class="math inline">\(Y\)</span> and each predictor be adequately summarized using a linear equation, or is the relationship more complicated? Historically, most methods for estimating <span class="math inline">\(f\)</span> have taken a linear form. In some situations, such an assumption is reasonable or even desirable. But often the true relationship is more complicated, in which case a linear model may not provide an accurate representation of the relationship between the input and output variables.</p>
</section>
</section>
<section id="how-do-we-estimate-f" class="level3">
<h3 class="anchored" data-anchor-id="how-do-we-estimate-f">How Do We Estimate <span class="math inline">\(f\)</span> ?</h3>
<p>Our goal is to apply a statistical learning method to the training data in order to estimate the unknown function <span class="math inline">\(f\)</span> .</p>
<ul>
<li><p>training data - observations and responses</p></li>
<li><p>parametric methods - model-based approach that makes an assumption about <span class="math inline">\(f\)</span> i.e.&nbsp;<em>linear model</em>, then fits or trains the model i.e.&nbsp;<em>least squares</em>. Beware of overfitting.</p></li>
<li><p>non-parametric - methods do not make explicit assumptions about the functional form of <span class="math inline">\(f\)</span> . Instead they seek an estimate of f that gets as close to the data points as possible without being too rough or wiggly. Such approaches can have a major advantage over parametric approaches: by avoiding the assumption of a particular functional form for <span class="math inline">\(f\)</span> , they have the potential to accurately fit a wider range of possible shapes for <span class="math inline">\(f\)</span> . Any parametric approach brings with it the possibility that the functional form used to estimate <span class="math inline">\(f\)</span> is very different from the true <span class="math inline">\(f\)</span> , in which case the resulting model will not fit the data well. In contrast, non-parametric approaches completely avoid this danger, since essentially no assumption about the form of <span class="math inline">\(f\)</span> is made. But non-parametric approaches do suffer from a major disadvantage: since they do not reduce the problem of estimating <span class="math inline">\(f\)</span> to a small number of parameters, a very large number of observations (far more than is typically needed for a parametric approach) is required in order to obtain an accurate estimate for <span class="math inline">\(f\)</span> .</p></li>
</ul>
</section>
<section id="the-trade-off-between-prediction-accuracy-and-model-interpretability" class="level3">
<h3 class="anchored" data-anchor-id="the-trade-off-between-prediction-accuracy-and-model-interpretability">The Trade-Off Between Prediction Accuracy and Model Interpretability</h3>
<p>Some methods such as linear regression are less flexible, or more restrictive, in the sense that they can produce just a relatively small range of shapes to estimate <span class="math inline">\(f\)</span> , such as linear function. Other methods such as thin plate splines are considerably more flexible because they can generate a much wider range of possible shapes to estimate <span class="math inline">\(f\)</span> .</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="interpretability_v_flexibility.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A representation of the tradeoff between flexibility and interpretability, using different statistical learning methods. In general, as the flexibility of a method increases, its interpretability decreases.</figcaption><p></p>
</figure>
</div>
<p>However, if we are mainly interested in inference, then restrictive models are much more interpretable. For instance, when inference is the goal, the linear model may be a good choice since it will be quite easy to understand the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1,X_2,…,X_p\)</span> .</p>
<p>Least squares linear regression, is relatively inflexible but is quite interpretable. The lasso, relies upon the linear model but uses an alternative fitting procedure for estimating the coefficients <span class="math inline">\(\beta_0, \beta_1, . . . , \beta_p\)</span> . The <em>lasso</em> is more restrictive in es- timating the coefficients, and sets a number of them to exactly zero. Hence in this sense the lasso is a less flexible approach than linear regression. It is also more interpretable than linear regression, because in the final model the response variable will only be related to a small subset of the predictors—namely, those with nonzero coefficient estimates. Generalized additive models (GAMs) instead extend the linear model to allow for certain non-linear relationships. Consequently, GAMs are more flexible than linear regression. They are also somewhat less interpretable than linear regression, because the relationship between each predictor and the response is now modeled using a curve. Finally, fully non-linear methods such as bagging, boosting, support vector machines with non-linear kernels, and neural networks (deep learning), are highly flexible approaches that are harder to interpret.</p>
<p>When prediction is the goal, one may suspect the most flexible method is the best choice as it would give the most accurate prediction. However, overfitting often leads us to less flexible methods with improved performance.</p>
</section>
<section id="supervised-versus-unsupervised-learning" class="level3">
<h3 class="anchored" data-anchor-id="supervised-versus-unsupervised-learning">Supervised Versus Unsupervised Learning</h3>
<p>In supervised learning problems, for each observation of the predictor measurement(s) <span class="math inline">\(x_i, i = 1, . . . , n\)</span> there is an associated response measurement <span class="math inline">\(y_i\)</span> . We wish to fit a model that relates the response to the predictors, with the aim of accurately predicting the response for future observations (prediction) or better understanding the relationship between the response and the predictors (inference). Many classical statistical learning methods such as linear regression and logistic regression,as well as more modern approaches such as GAM, boosting, and support vector machines, operate in the supervised learning domain.</p>
<p>Unsupervised learning describes the somewhat more challenging situation in which for every observation <span class="math inline">\(i = 1,…,n\)</span> , we observe a vector of measurements <span class="math inline">\(x_i\)</span> but no associated response <span class="math inline">\(y_i\)</span> . It is not possible to fit a linear regression model, since there is no response variable to predict. In this setting, we are in some sense working blind; the situation is referred to as unsupervised because we lack a response variable that can supervise our analysis.</p>
<p>One statistical learning tool that we may use in this setting is cluster analysis, or clustering. The goal of cluster analysis is to ascertain, on the basis of <span class="math inline">\(x_1,…,x_n\)</span> , whether the observations fall into relatively distinct groups. Identifying such groups can be of interest because it might be that the groups differ with respect to some property of interest.</p>
</section>
<section id="regression-versus-classification-problems" class="level3">
<h3 class="anchored" data-anchor-id="regression-versus-classification-problems">Regression Versus Classification Problems</h3>
<p>Variables can be characterized as either quantitative or qualitative (also known as categorical). Quantitative variables take on numerical values. In contrast, qualitative variables take on values in one of K different classes, or categories. We tend to refer to problems with a quantitative response as regression problems, while those involving a qualitative response are often referred to as classification problems. Least squares linear regression is used with a quantitative response, whereas logistic regression is typically used with a qualitative (two-class, or binary) response. K-nearest neighbors and boosting can be used in the case of either quantitative or qualitative responses.</p>
<p>We tend to select statistical learning methods on the basis of whether the response is quantitative or qualitative. However, whether the predictors are qualitative or quantitative is generally considered less important.</p>
</section>
</section>
<section id="assessing-model-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="assessing-model-accuracy">Assessing Model Accuracy</h2>
<p>No one method dominates all others over all possible data sets. Hence it is an important task to decide for any given set of data which method produces the best results. Selecting the best approach can be one of the most challenging parts of performing statistical learning in practice.</p>
<section id="measuring-quality-of-fit" class="level3">
<h3 class="anchored" data-anchor-id="measuring-quality-of-fit">Measuring Quality of Fit</h3>
<p>In order to evaluate the performance of a statistical learning method on a given data set, we need some way to measure how well its predictions actually match the observed data. That is, we need to quantify the extent to which the predicted response value for a given observation is close to the true response value for that observation. In the regression setting, the most commonly-used measure is the mean squared error (MSE), given by</p>
<p><span class="math inline">\(MSE = \frac{1}{n}\Sigma^n_{i=1}(y_i-\hat{f}(x_i))^2\)</span> ,</p>
<p>where <span class="math inline">\(\hat{f}(x_i)\)</span> is the prediction that <span class="math inline">\(\hat{f}\)</span> gives for the <span class="math inline">\(i\)</span>th observation.</p>
<p>The MSE will be small if the predicted responses are very close to the true responses, and will be large if for some of the observations, the predicted and true responses differ substantially.</p>
<p>The MSE in is computed using the training data that was used tofit the model, and so should more accurately be referred to as the training MSE. But in general, we do not really care how well the method works training on the training data. Rather, we are interested in the accuracy of the predictions that we obtain when we apply our method to previously unseen test data. Suppose that we have clinical measurements (e.g.&nbsp;weight, blood pressure, height, age, family history of disease) for a number of patients, as well as information about whether each patient has diabetes. We can use these patients to train a statistical learning method to predict risk of diabetes based on clinical measurements. In practice, we want this method to accurately predict diabetes risk for future patients based on their clinical measurements. We are not very interested in whether or not the method accurately predicts diabetes risk for patients used to train the model, since we already know which of those patients have diabetes.</p>
<p>We want to choose the method that gives the lowest test MSE, as opposed to the lowest training MSE. If we had a large number of test observations, we could compute</p>
<p><span class="math inline">\(Ave(y_0 - \hat{f}(x_0))^2\)</span> ,</p>
<p>the average squared prediction error for these test observations <span class="math inline">\((x_0,y_0)\)</span> . We’d like to select the model for which this quantity is as small as possible.</p>
<p>The degrees of freedom is a quantity that summarizes the flexibility of a curve. When a given method yields a small training MSE but a large test MSE, we are said to be overfitting the data. Regardless of whether or not overfitting has occurred, we almost always expect the training MSE to be smaller than the test MSE because most statistical learning methods either directly or indirectly seek to minimize the training MSE. Overfitting refers specifically to the case in which a less flexible model would have yielded a smaller test MSE.</p>
<p>Plotting of MSE versus degrees of freedom as model flexibility can guide model selection. Cross-validation can estimate the minimum test MSE using the training data.</p>
</section>
<section id="the-bias-variance-trade-off" class="level3">
<h3 class="anchored" data-anchor-id="the-bias-variance-trade-off">The Bias-Variance Trade-Off</h3>
<p>It is possible to show that the <strong>expected test MSE</strong>, for a given value <span class="math inline">\(x_0\)</span> , can always be decomposed into the sum of three fundamental quantities: the variance of $f(x_0)$, the squared bias of <span class="math inline">\(f(x_0)\)</span> and the variance of the error terms <span class="math inline">\(\epsilon\)</span> .</p>
<p><span class="math inline">\(E(y_0-\hat{f}(x_0))2 = Var(\hat{f}(x_0)) + [Bias(\hat{f}(x_0))^2 + Var(\epsilon)\)</span> .</p>
<p>we need to select a statistical learning method that simultaneously achieves low variance and low bias. Note that variance is inherently a nonnegative quantity, and squared bias is also nonnegative. Hence, we see that the expected test MSE can never lie below <span class="math inline">\(Var(\epsilon)\)</span> , the irreducible error.</p>
<p>Variance refers to the amount by which <span class="math inline">\(\hat{f}\)</span> would change if we estimated it using a different training data set. In general, more flexible statistical methods have higher variance. Bias refers to the error that is introduced by approximating a real-life problem, which may be extremely complicated, by a much simpler model. Generally, more flexible methods result in less bias.</p>
<p>As a general rule, as we use more flexible methods, the variance will increase and the bias will decrease. The relative rate of change of these two quantities determines whether the test MSE increases or decreases. As we increase the flexibility of a class of methods, the bias tends to initially decrease faster than the variance increases. Consequently, the expected test MSE declines. However, at some point increasing flexibility has little impact on the bias but starts to significantly increase the variance. When this happens the test MSE increases.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="var_bias_error.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Squared bias (blue curve), variance (orange curve), Var(ε) (dashed line), and test MSE (red curve) for the three data sets. The vertical dotted line indicates the flexibility level corresponding to the smallest test MSE.</figcaption><p></p>
</figure>
</div>
<p>In a real-life situation in which <span class="math inline">\(f\)</span> is unobserved, it is generally not possible to explicitly compute the test MSE, bias, or variance for a statistical learning method. Nevertheless, one should always keep the <strong>bias-variance trade-off</strong> in mind.</p>
</section>
<section id="the-classification-setting" class="level3">
<h3 class="anchored" data-anchor-id="the-classification-setting">The Classification Setting</h3>
<p>When response variable <span class="math inline">\(y\)</span> is qualitative, the most common approach for quantifying the accuracy of our estimate <span class="math inline">\(\hat{f}\)</span> is the training error rate, the proportion of mistakes that are made if we apply our estimate <span class="math inline">\(\hat{f}\)</span> to the training observations:</p>
<p><span class="math inline">\(\frac{1}{n}\Sigma^n_{i=1}I(y_i!=\hat{y}_i)\)</span> .</p>
<p>Here <span class="math inline">\(\hat{y}_i\)</span> is the predicted class label for the <span class="math inline">\(i\)</span> th observation using <span class="math inline">\(f\)</span> . And <span class="math inline">\(I(y_i != \hat{y}_i)\)</span> is an <em>indicator variable</em> that equals 1 if <span class="math inline">\(y_i ̸!= \hat{y}_i\)</span> and zero if <span class="math inline">\(y_i = \hat{y}_i\)</span> . If <span class="math inline">\(I(y_i ̸!= \hat{y}_i) = 0\)</span> then the <span class="math inline">\(i\)</span> th observation was classified correctly by our classification method; otherwise it was misclassified. Hence the training error computes the fraction of incorrect classifications.</p>
<p>The test error rate associated with a set of test observations of the form <span class="math inline">\((x_0, y_0)\)</span> is given by</p>
<p><span class="math inline">\(Ave(I(y_0 ̸!=ˆ\hat{y}_0))\)</span> ,</p>
<p>where <span class="math inline">\(\hat{y}_0\)</span> is the predicted class label that results from applying the classifier to the test observation with predictor <span class="math inline">\(x_0\)</span>. A good classifier is one for which the test error is smallest.</p>
</section>
<section id="the-bayes-classifier" class="level3">
<h3 class="anchored" data-anchor-id="the-bayes-classifier">The Bayes Classifier</h3>
<p>The test error rate is minimized, on average, by a very simple classifier that assigns each observation to the most likely class, given its predictor values. In other words, we should simply assign a test observation with predictor vector <span class="math inline">\(x_0\)</span> to the class <span class="math inline">\(j\)</span> for which</p>
<p><span class="math inline">\(Pr(Y = j|X = x_0)\)</span></p>
<p>is largest. This conditional probability is the probability that <span class="math inline">\(Y = j\)</span> , given the observed predictor vector <span class="math inline">\(x_0\)</span> . This very simple classifier is called the <em>Bayes classifier</em>. In a two-class problem where there are only two possible response values, say class 1 or class 2, the Bayes classifier corresponds to predicting class one if <span class="math inline">\(Pr(Y = 1|X = x_0) &gt; 0.5\)</span> , and class two otherwise.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bayes_classifier.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A simulated data set consisting of 100 observations in each of two groups, indicated in blue and in orange. The purple dashed line represents the Bayes decision boundary. The orange background grid indicates the region in which a test observation will be assigned to the orange class, and the blue background grid indicates the region in which a test observation will be assigned to the blue class.</figcaption><p></p>
</figure>
</div>
<p>The Bayes classifier produces the lowest possible test error rate, called the Bayes error rate. Since the Bayes classifier will always choose the class for which is largest, the error rate will be <span class="math inline">\(1−max_j Pr(Y = j|X = x_0) at X = x_0\)</span> . In general, the overall Bayes error rate is given by</p>
<p><span class="math inline">\(1−E(max_jPr(Y =j|X))\)</span> ,</p>
<p>where the expectation averages the probability over all possible values of <span class="math inline">\(X\)</span> . If the Bayes error rate is greater than zero, the classes overlap in the true population so <span class="math inline">\(max_j Pr(Y = j|X = x_0) &lt; 1\)</span> for some values of <span class="math inline">\(x_0\)</span> . The Bayes error rate is analogous to the irreducible error.</p>
</section>
<section id="k-nearest-neighbors" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors">K-Nearest Neighbors</h3>
<p>In theory we would always like to predict qualitative responses using the Bayes classifier. But for real data, we do not know the conditional distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> , and so computing the Bayes classifier is impossible. Therefore, the Bayes classifier serves as an unattainable gold standard against which to compare other methods. Many approaches attempt to estimate the conditional distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> , and then classify a given observation to the class with highest estimated probability. One such method is the K-nearest neighbors (KNN) classifier. Given a positive integer <span class="math inline">\(K\)</span> and a test observation <span class="math inline">\(x_0\)</span> , the KNN classifier first identifies the <span class="math inline">\(K\)</span> points in the training data that are closest to <span class="math inline">\(x_0\)</span> , represented by <span class="math inline">\(N_0\)</span> . It then estimates the conditional probability for class <span class="math inline">\(j\)</span> as the fraction of points in <span class="math inline">\(N_0\)</span> whose response values equal <span class="math inline">\(j\)</span> :</p>
<p><span class="math inline">\(Pr(Y =j|X =x_0)= \frac{1}{K} \Sigma_{i\element N_0} I(y_i =j)\)</span> .</p>
<p>Finally, KNN classifies the test observation <span class="math inline">\(x_0\)</span> to the class with the largest probability.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="KnnClassification.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Example of k-NN classification. The test sample (green dot) should be classified either to blue squares or to red triangles. If k = 3 (solid line circle) it is assigned to the red triangles because there are 2 triangles and only 1 square inside the inner circle. If k = 5 (dashed line circle) it is assigned to the blue squares (3 squares vs.&nbsp;2 triangles inside the outer circle). -from Wikipedia.</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="knn_k10.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The black curve indicates the KNN decision boundary on data using K = 10. The Bayes decision boundary is shown as a purple dashed line. The KNN and Bayes decision boundaries are very similar.</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="knn_k1_k100.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A comparison of the KNN decision boundaries (solid black curves) obtained using K = 1 and K = 100 on data. With K = 1, the decision boundary is overly flexible, while with K = 100 it is not sufficiently flexible. The Bayes decision boundary is shown as a purple dashed line.</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="knn_training_error_rate.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The KNN training error rate (blue, 200 observations) and test error rate (orange, 5,000 observations) on the data, as the level of flexibility (assessed using 1/K on the log scale) increases, or equivalently as the number of neighbors K decreases. The black dashed line indicates the Bayes error rate. The jumpiness of the curves is due to the small size of the training data set.</figcaption><p></p>
</figure>
</div>
<p>The test error exhibits a characteristic U-shape, declining at first (with a minimum at approximately K = 10) before increasing again when the method becomes excessively flexible and overfits.</p>
</section>
</section>
<section id="lab-in-r" class="level2">
<h2 class="anchored" data-anchor-id="lab-in-r">Lab in R</h2>
<p>Posit (formerly known as RStudio), provides an R integrated development environment (IDE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic Commands</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">+</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2 10  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x" "y"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x, y)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>?matrix</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    3
[2,]    2    4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    2
[2,]    3    4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 1.000000 1.732051
[2,] 1.414214 2.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> .<span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9949618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1303</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1.1439763145  1.3421293656  2.1853904757  0.5363925179  0.0631929665
 [6]  0.5022344825 -0.0004167247  0.5658198405 -0.5725226890 -1.1102250073
[11] -0.0486871234 -0.6956562176  0.8289174803  0.2066528551 -0.2356745091
[16] -0.5563104914 -0.3647543571  0.8623550343 -0.6307715354  0.3136021252
[21] -0.9314953177  0.8238676185  0.5233707021  0.7069214120  0.4202043256
[26] -0.2690521547 -1.5103172999 -0.6902124766 -0.1434719524 -1.0135274099
[31]  1.5732737361  0.0127465055  0.8726470499  0.4220661905 -0.0188157917
[36]  2.6157489689 -0.6931401748 -0.2663217810 -0.7206364412  1.3677342065
[41]  0.2640073322  0.6321868074 -1.3306509858  0.0268888182  1.0406363208
[46]  1.3120237985 -0.0300020767 -0.2500257125  0.0234144857  1.6598706557</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01103557</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7328675</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(y)) <span class="co"># SD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8560768</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8560768</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphics</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab =</span> <span class="st">"this is the x-axis"</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> <span class="st">"this is the y-axis"</span>, <span class="at">main =</span> <span class="st">"Plot of X vs Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"Figure.pdf"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span>pi, pi, <span class="at">length =</span> <span class="dv">50</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -3.14159265 -3.01336438 -2.88513611 -2.75690784 -2.62867957 -2.50045130
 [7] -2.37222302 -2.24399475 -2.11576648 -1.98753821 -1.85930994 -1.73108167
[13] -1.60285339 -1.47462512 -1.34639685 -1.21816858 -1.08994031 -0.96171204
[19] -0.83348377 -0.70525549 -0.57702722 -0.44879895 -0.32057068 -0.19234241
[25] -0.06411414  0.06411414  0.19234241  0.32057068  0.44879895  0.57702722
[31]  0.70525549  0.83348377  0.96171204  1.08994031  1.21816858  1.34639685
[37]  1.47462512  1.60285339  1.73108167  1.85930994  1.98753821  2.11576648
[43]  2.24399475  2.37222302  2.50045130  2.62867957  2.75690784  2.88513611
[49]  3.01336438  3.14159265</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, <span class="cf">function</span>(x, y) <span class="fu">cos</span>(y) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(x, y, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fa <span class="ot">&lt;-</span> (f <span class="sc">-</span> <span class="fu">t</span>(f)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(x, y, fa, <span class="at">nlevels =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(x, y, fa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, fa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, fa, <span class="at">theta =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, fa, <span class="at">theta =</span> <span class="dv">30</span>, <span class="at">phi =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, fa, <span class="at">theta =</span> <span class="dv">30</span>, <span class="at">phi =</span> <span class="dv">70</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, fa, <span class="at">theta =</span> <span class="dv">30</span>, <span class="at">phi =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Indexing Data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14
[3,]    3    7   11   15
[4,]    4    8   12   16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    5   13
[2,]    7   15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    5    9   13
[2,]    6   10   14
[3,]    7   11   15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    2    6   10   14
[2,]    4    8   12   16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading Data</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mpg cylinders displacement horsepower weight acceleration year origin
1  18         8          307        130   3504         12.0   70      1
2  15         8          350        165   3693         11.5   70      1
3  18         8          318        150   3436         11.0   70      1
4  16         8          304        150   3433         12.0   70      1
5  17         8          302        140   3449         10.5   70      1
6  15         8          429        198   4341         10.0   70      1
                       name
1 chevrolet chevelle malibu
2         buick skylark 320
3        plymouth satellite
4             amc rebel sst
5               ford torino
6          ford galaxie 500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(Auto, <span class="st">"Auto.data"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>Auto <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Auto.data"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>Auto <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Auto.data"</span>, <span class="at">header =</span> T, <span class="at">na.strings =</span> <span class="st">"?"</span>, <span class="at">stringsAsFactors =</span> T)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Auto &lt;- read.csv("Auto.csv", na.strings = "?", stringsAsFactors = T)</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>Auto <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Auto)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mpg"          "cylinders"    "displacement" "horsepower"   "weight"      
[6] "acceleration" "year"         "origin"       "name"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional Graphical and Numerical Summaries</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Auto<span class="sc">$</span>cylinders, Auto<span class="sc">$</span>mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Auto)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cylinders, mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cylinders <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cylinders)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cylinders, mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-13.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cylinders, mpg, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-14.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cylinders, mpg, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">varwidth =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-15.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cylinders, mpg, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">varwidth =</span> T, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-16.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cylinders, mpg, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">varwidth =</span> T, <span class="at">xlab =</span> <span class="st">"cylinders"</span>, <span class="at">ylab =</span> <span class="st">"MPG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-17.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-18.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mpg, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-19.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mpg, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">breaks =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-20.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(horsepower, mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-21.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">main =</span> <span class="st">"Anderson's Iris Data -- 3 species"</span>,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green3"</span>, <span class="st">"blue"</span>)[<span class="fu">unclass</span>(iris<span class="sc">$</span>Species)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-22.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris, <span class="at">log =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="co"># log the first four</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Lengths and Widths in [log]"</span>, <span class="at">line.main=</span><span class="fl">1.5</span>, <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-23.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Sepal.Length,iris<span class="sc">$</span>Petal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-24.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>college <span class="ot">&lt;-</span> College</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(college)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Private"     "Apps"        "Accept"      "Enroll"      "Top10perc"  
 [6] "Top25perc"   "F.Undergrad" "P.Undergrad" "Outstate"    "Room.Board" 
[11] "Books"       "Personal"    "PhD"         "Terminal"    "S.F.Ratio"  
[16] "perc.alumni" "Expend"      "Grad.Rate"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(college)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Abilene Christian University"                 
  [2] "Adelphi University"                           
  [3] "Adrian College"                               
  [4] "Agnes Scott College"                          
  [5] "Alaska Pacific University"                    
  [6] "Albertson College"                            
  [7] "Albertus Magnus College"                      
  [8] "Albion College"                               
  [9] "Albright College"                             
 [10] "Alderson-Broaddus College"                    
 [11] "Alfred University"                            
 [12] "Allegheny College"                            
 [13] "Allentown Coll. of St. Francis de Sales"      
 [14] "Alma College"                                 
 [15] "Alverno College"                              
 [16] "American International College"               
 [17] "Amherst College"                              
 [18] "Anderson University"                          
 [19] "Andrews University"                           
 [20] "Angelo State University"                      
 [21] "Antioch University"                           
 [22] "Appalachian State University"                 
 [23] "Aquinas College"                              
 [24] "Arizona State University Main campus"         
 [25] "Arkansas College (Lyon College)"              
 [26] "Arkansas Tech University"                     
 [27] "Assumption College"                           
 [28] "Auburn University-Main Campus"                
 [29] "Augsburg College"                             
 [30] "Augustana College IL"                         
 [31] "Augustana College"                            
 [32] "Austin College"                               
 [33] "Averett College"                              
 [34] "Baker University"                             
 [35] "Baldwin-Wallace College"                      
 [36] "Barat College"                                
 [37] "Bard College"                                 
 [38] "Barnard College"                              
 [39] "Barry University"                             
 [40] "Baylor University"                            
 [41] "Beaver College"                               
 [42] "Bellarmine College"                           
 [43] "Belmont Abbey College"                        
 [44] "Belmont University"                           
 [45] "Beloit College"                               
 [46] "Bemidji State University"                     
 [47] "Benedictine College"                          
 [48] "Bennington College"                           
 [49] "Bentley College"                              
 [50] "Berry College"                                
 [51] "Bethany College"                              
 [52] "Bethel College KS"                            
 [53] "Bethel College"                               
 [54] "Bethune Cookman College"                      
 [55] "Birmingham-Southern College"                  
 [56] "Blackburn College"                            
 [57] "Bloomsburg Univ. of Pennsylvania"             
 [58] "Bluefield College"                            
 [59] "Bluffton College"                             
 [60] "Boston University"                            
 [61] "Bowdoin College"                              
 [62] "Bowling Green State University"               
 [63] "Bradford College"                             
 [64] "Bradley University"                           
 [65] "Brandeis University"                          
 [66] "Brenau University"                            
 [67] "Brewton-Parker College"                       
 [68] "Briar Cliff College"                          
 [69] "Bridgewater College"                          
 [70] "Brigham Young University at Provo"            
 [71] "Brown University"                             
 [72] "Bryn Mawr College"                            
 [73] "Bucknell University"                          
 [74] "Buena Vista College"                          
 [75] "Butler University"                            
 [76] "Cabrini College"                              
 [77] "Caldwell College"                             
 [78] "California Lutheran University"               
 [79] "California Polytechnic-San Luis"              
 [80] "California State University at Fresno"        
 [81] "Calvin College"                               
 [82] "Campbell University"                          
 [83] "Campbellsville College"                       
 [84] "Canisius College"                             
 [85] "Capital University"                           
 [86] "Capitol College"                              
 [87] "Carleton College"                             
 [88] "Carnegie Mellon University"                   
 [89] "Carroll College"                              
 [90] "Carson-Newman College"                        
 [91] "Carthage College"                             
 [92] "Case Western Reserve University"              
 [93] "Castleton State College"                      
 [94] "Catawba College"                              
 [95] "Catholic University of America"               
 [96] "Cazenovia College"                            
 [97] "Cedar Crest College"                          
 [98] "Cedarville College"                           
 [99] "Centenary College"                            
[100] "Centenary College of Louisiana"               
[101] "Center for Creative Studies"                  
[102] "Central College"                              
[103] "Central Connecticut State University"         
[104] "Central Missouri State University"            
[105] "Central Washington University"                
[106] "Central Wesleyan College"                     
[107] "Centre College"                               
[108] "Chapman University"                           
[109] "Chatham College"                              
[110] "Chestnut Hill College"                        
[111] "Christendom College"                          
[112] "Christian Brothers University"                
[113] "Christopher Newport University"               
[114] "Claflin College"                              
[115] "Claremont McKenna College"                    
[116] "Clark University"                             
[117] "Clarke College"                               
[118] "Clarkson University"                          
[119] "Clemson University"                           
[120] "Clinch Valley Coll. of  the Univ. of Virginia"
[121] "Coe College"                                  
[122] "Coker College"                                
[123] "Colby College"                                
[124] "Colgate University"                           
[125] "College Misericordia"                         
[126] "College of Charleston"                        
[127] "College of Mount St. Joseph"                  
[128] "College of Mount St. Vincent"                 
[129] "College of Notre Dame"                        
[130] "College of Notre Dame of Maryland"            
[131] "College of Saint Benedict"                    
[132] "College of Saint Catherine"                   
[133] "College of Saint Elizabeth"                   
[134] "College of Saint Rose"                        
[135] "College of Santa Fe"                          
[136] "College of St. Joseph"                        
[137] "College of St. Scholastica"                   
[138] "College of the Holy Cross"                    
[139] "College of William and Mary"                  
[140] "College of Wooster"                           
[141] "Colorado College"                             
[142] "Colorado State University"                    
[143] "Columbia College MO"                          
[144] "Columbia College"                             
[145] "Columbia University"                          
[146] "Concordia College at St. Paul"                
[147] "Concordia Lutheran College"                   
[148] "Concordia University CA"                      
[149] "Concordia University"                         
[150] "Connecticut College"                          
[151] "Converse College"                             
[152] "Cornell College"                              
[153] "Creighton University"                         
[154] "Culver-Stockton College"                      
[155] "Cumberland College"                           
[156] "D'Youville College"                           
[157] "Dana College"                                 
[158] "Daniel Webster College"                       
[159] "Dartmouth College"                            
[160] "Davidson College"                             
[161] "Defiance College"                             
[162] "Delta State University"                       
[163] "Denison University"                           
[164] "DePauw University"                            
[165] "Dickinson College"                            
[166] "Dickinson State University"                   
[167] "Dillard University"                           
[168] "Doane College"                                
[169] "Dominican College of Blauvelt"                
[170] "Dordt College"                                
[171] "Dowling College"                              
[172] "Drake University"                             
[173] "Drew University"                              
[174] "Drury College"                                
[175] "Duke University"                              
[176] "Earlham College"                              
[177] "East Carolina University"                     
[178] "East Tennessee State University"              
[179] "East Texas Baptist University"                
[180] "Eastern College"                              
[181] "Eastern Connecticut State University"         
[182] "Eastern Illinois University"                  
[183] "Eastern Mennonite College"                    
[184] "Eastern Nazarene College"                     
[185] "Eckerd College"                               
[186] "Elizabethtown College"                        
[187] "Elmira College"                               
[188] "Elms College"                                 
[189] "Elon College"                                 
[190] "Embry Riddle Aeronautical University"         
[191] "Emory &amp; Henry College"                        
[192] "Emory University"                             
[193] "Emporia State University"                     
[194] "Erskine College"                              
[195] "Eureka College"                               
[196] "Evergreen State College"                      
[197] "Fairfield University"                         
[198] "Fayetteville State University"                
[199] "Ferrum College"                               
[200] "Flagler College"                              
[201] "Florida Institute of Technology"              
[202] "Florida International University"             
[203] "Florida Southern College"                     
[204] "Florida State University"                     
[205] "Fontbonne College"                            
[206] "Fordham University"                           
[207] "Fort Lewis College"                           
[208] "Francis Marion University"                    
[209] "Franciscan University of Steubenville"        
[210] "Franklin College"                             
[211] "Franklin Pierce College"                      
[212] "Freed-Hardeman University"                    
[213] "Fresno Pacific College"                       
[214] "Furman University"                            
[215] "Gannon University"                            
[216] "Gardner Webb University"                      
[217] "Geneva College"                               
[218] "George Fox College"                           
[219] "George Mason University"                      
[220] "George Washington University"                 
[221] "Georgetown College"                           
[222] "Georgetown University"                        
[223] "Georgia Institute of Technology"              
[224] "Georgia State University"                     
[225] "Georgian Court College"                       
[226] "Gettysburg College"                           
[227] "Goldey Beacom College"                        
[228] "Gonzaga University"                           
[229] "Gordon College"                               
[230] "Goshen College"                               
[231] "Goucher College"                              
[232] "Grace College and Seminary"                   
[233] "Graceland College"                            
[234] "Grand Valley State University"                
[235] "Green Mountain College"                       
[236] "Greensboro College"                           
[237] "Greenville College"                           
[238] "Grinnell College"                             
[239] "Grove City College"                           
[240] "Guilford College"                             
[241] "Gustavus Adolphus College"                    
[242] "Gwynedd Mercy College"                        
[243] "Hamilton College"                             
[244] "Hamline University"                           
[245] "Hampden - Sydney College"                     
[246] "Hampton University"                           
[247] "Hanover College"                              
[248] "Hardin-Simmons University"                    
[249] "Harding University"                           
[250] "Hartwick College"                             
[251] "Harvard University"                           
[252] "Harvey Mudd College"                          
[253] "Hastings College"                             
[254] "Hendrix College"                              
[255] "Hillsdale College"                            
[256] "Hiram College"                                
[257] "Hobart and William Smith Colleges"            
[258] "Hofstra University"                           
[259] "Hollins College"                              
[260] "Hood College"                                 
[261] "Hope College"                                 
[262] "Houghton College"                             
[263] "Huntingdon College"                           
[264] "Huntington College"                           
[265] "Huron University"                             
[266] "Husson College"                               
[267] "Illinois Benedictine College"                 
[268] "Illinois College"                             
[269] "Illinois Institute of Technology"             
[270] "Illinois State University"                    
[271] "Illinois Wesleyan University"                 
[272] "Immaculata College"                           
[273] "Incarnate Word College"                       
[274] "Indiana State University"                     
[275] "Indiana University at Bloomington"            
[276] "Indiana Wesleyan University"                  
[277] "Iona College"                                 
[278] "Iowa State University"                        
[279] "Ithaca College"                               
[280] "James Madison University"                     
[281] "Jamestown College"                            
[282] "Jersey City State College"                    
[283] "John Brown University"                        
[284] "John Carroll University"                      
[285] "Johns Hopkins University"                     
[286] "Johnson State College"                        
[287] "Judson College"                               
[288] "Juniata College"                              
[289] "Kansas State University"                      
[290] "Kansas Wesleyan University"                   
[291] "Keene State College"                          
[292] "Kentucky Wesleyan College"                    
[293] "Kenyon College"                               
[294] "Keuka College"                                
[295] "King's College"                               
[296] "King College"                                 
[297] "Knox College"                                 
[298] "La Roche College"                             
[299] "La Salle University"                          
[300] "Lafayette College"                            
[301] "LaGrange College"                             
[302] "Lake Forest College"                          
[303] "Lakeland College"                             
[304] "Lamar University"                             
[305] "Lambuth University"                           
[306] "Lander University"                            
[307] "Lawrence University"                          
[308] "Le Moyne College"                             
[309] "Lebanon Valley College"                       
[310] "Lehigh University"                            
[311] "Lenoir-Rhyne College"                         
[312] "Lesley College"                               
[313] "LeTourneau University"                        
[314] "Lewis and Clark College"                      
[315] "Lewis University"                             
[316] "Lincoln Memorial University"                  
[317] "Lincoln University"                           
[318] "Lindenwood College"                           
[319] "Linfield College"                             
[320] "Livingstone College"                          
[321] "Lock Haven University of Pennsylvania"        
[322] "Longwood College"                             
[323] "Loras College"                                
[324] "Louisiana College"                            
[325] "Louisiana State University at Baton Rouge"    
[326] "Louisiana Tech University"                    
[327] "Loyola College"                               
[328] "Loyola Marymount University"                  
[329] "Loyola University"                            
[330] "Loyola University Chicago"                    
[331] "Luther College"                               
[332] "Lycoming College"                             
[333] "Lynchburg College"                            
[334] "Lyndon State College"                         
[335] "Macalester College"                           
[336] "MacMurray College"                            
[337] "Malone College"                               
[338] "Manchester College"                           
[339] "Manhattan College"                            
[340] "Manhattanville College"                       
[341] "Mankato State University"                     
[342] "Marian College of Fond du Lac"                
[343] "Marietta College"                             
[344] "Marist College"                               
[345] "Marquette University"                         
[346] "Marshall University"                          
[347] "Mary Baldwin College"                         
[348] "Mary Washington College"                      
[349] "Marymount College Tarrytown"                  
[350] "Marymount Manhattan College"                  
[351] "Marymount University"                         
[352] "Maryville College"                            
[353] "Maryville University"                         
[354] "Marywood College"                             
[355] "Massachusetts Institute of Technology"        
[356] "Mayville State University"                    
[357] "McKendree College"                            
[358] "McMurry University"                           
[359] "McPherson College"                            
[360] "Mercer University"                            
[361] "Mercyhurst College"                           
[362] "Meredith College"                             
[363] "Merrimack College"                            
[364] "Mesa State College"                           
[365] "Messiah College"                              
[366] "Miami University at Oxford"                   
[367] "Michigan State University"                    
[368] "Michigan Technological University"            
[369] "MidAmerica Nazarene College"                  
[370] "Millersville University of Penn."             
[371] "Milligan College"                             
[372] "Millikin University"                          
[373] "Millsaps College"                             
[374] "Milwaukee School of Engineering"              
[375] "Mississippi College"                          
[376] "Mississippi State University"                 
[377] "Mississippi University for Women"             
[378] "Missouri Southern State College"              
[379] "Missouri Valley College"                      
[380] "Monmouth College IL"                          
[381] "Monmouth College"                             
[382] "Montana College of Mineral Sci. &amp; Tech."      
[383] "Montana State University"                     
[384] "Montclair State University"                   
[385] "Montreat-Anderson College"                    
[386] "Moorhead State University"                    
[387] "Moravian College"                             
[388] "Morehouse College"                            
[389] "Morningside College"                          
[390] "Morris College"                               
[391] "Mount Holyoke College"                        
[392] "Mount Marty College"                          
[393] "Mount Mary College"                           
[394] "Mount Mercy College"                          
[395] "Mount Saint Clare College"                    
[396] "Mount Saint Mary's College"                   
[397] "Mount Saint Mary College"                     
[398] "Mount St. Mary's College"                     
[399] "Mount Union College"                          
[400] "Mount Vernon Nazarene College"                
[401] "Muhlenberg College"                           
[402] "Murray State University"                      
[403] "Muskingum College"                            
[404] "National-Louis University"                    
[405] "Nazareth College of Rochester"                
[406] "New Jersey Institute of Technology"           
[407] "New Mexico Institute of Mining and Tech."     
[408] "New York University"                          
[409] "Newberry College"                             
[410] "Niagara University"                           
[411] "North Adams State College"                    
[412] "North Carolina A. &amp; T. State University"      
[413] "North Carolina State University at Raleigh"   
[414] "North Carolina Wesleyan College"              
[415] "North Central College"                        
[416] "North Dakota State University"                
[417] "North Park College"                           
[418] "Northeast Missouri State University"          
[419] "Northeastern University"                      
[420] "Northern Arizona University"                  
[421] "Northern Illinois University"                 
[422] "Northwest Missouri State University"          
[423] "Northwest Nazarene College"                   
[424] "Northwestern College"                         
[425] "Northwestern University"                      
[426] "Norwich University"                           
[427] "Notre Dame College"                           
[428] "Oakland University"                           
[429] "Oberlin College"                              
[430] "Occidental College"                           
[431] "Oglethorpe University"                        
[432] "Ohio Northern University"                     
[433] "Ohio University"                              
[434] "Ohio Wesleyan University"                     
[435] "Oklahoma Baptist University"                  
[436] "Oklahoma Christian University"                
[437] "Oklahoma State University"                    
[438] "Otterbein College"                            
[439] "Ouachita Baptist University"                  
[440] "Our Lady of the Lake University"              
[441] "Pace University"                              
[442] "Pacific Lutheran University"                  
[443] "Pacific Union College"                        
[444] "Pacific University"                           
[445] "Pembroke State University"                    
[446] "Pennsylvania State Univ. Main Campus"         
[447] "Pepperdine University"                        
[448] "Peru State College"                           
[449] "Pfeiffer College"                             
[450] "Philadelphia Coll. of Textiles and Sci."      
[451] "Phillips University"                          
[452] "Piedmont College"                             
[453] "Pikeville College"                            
[454] "Pitzer College"                               
[455] "Point Loma Nazarene College"                  
[456] "Point Park College"                           
[457] "Polytechnic University"                       
[458] "Prairie View A. and M. University"            
[459] "Presbyterian College"                         
[460] "Princeton University"                         
[461] "Providence College"                           
[462] "Purdue University at West Lafayette"          
[463] "Queens College"                               
[464] "Quincy University"                            
[465] "Quinnipiac College"                           
[466] "Radford University"                           
[467] "Ramapo College of New Jersey"                 
[468] "Randolph-Macon College"                       
[469] "Randolph-Macon Woman's College"               
[470] "Reed College"                                 
[471] "Regis College"                                
[472] "Rensselaer Polytechnic Institute"             
[473] "Rhodes College"                               
[474] "Rider University"                             
[475] "Ripon College"                                
[476] "Rivier College"                               
[477] "Roanoke College"                              
[478] "Rockhurst College"                            
[479] "Rocky Mountain College"                       
[480] "Roger Williams University"                    
[481] "Rollins College"                              
[482] "Rosary College"                               
[483] "Rowan College of New Jersey"                  
[484] "Rutgers at New Brunswick"                     
[485] "Rutgers State University at Camden"           
[486] "Rutgers State University at Newark"           
[487] "Sacred Heart University"                      
[488] "Saint Ambrose University"                     
[489] "Saint Anselm College"                         
[490] "Saint Cloud State University"                 
[491] "Saint Francis College IN"                     
[492] "Saint Francis College"                        
[493] "Saint John's University"                      
[494] "Saint Joseph's College IN"                    
[495] "Saint Joseph's College"                       
[496] "Saint Joseph's University"                    
[497] "Saint Joseph College"                         
[498] "Saint Louis University"                       
[499] "Saint Mary's College"                         
[500] "Saint Mary's College of Minnesota"            
[501] "Saint Mary-of-the-Woods College"              
[502] "Saint Michael's College"                      
[503] "Saint Olaf College"                           
[504] "Saint Peter's College"                        
[505] "Saint Vincent College"                        
[506] "Saint Xavier University"                      
[507] "Salem-Teikyo University"                      
[508] "Salem College"                                
[509] "Salisbury State University"                   
[510] "Samford University"                           
[511] "San Diego State University"                   
[512] "Santa Clara University"                       
[513] "Sarah Lawrence College"                       
[514] "Savannah Coll. of Art and Design"             
[515] "Schreiner College"                            
[516] "Scripps College"                              
[517] "Seattle Pacific University"                   
[518] "Seattle University"                           
[519] "Seton Hall University"                        
[520] "Seton Hill College"                           
[521] "Shippensburg University of Penn."             
[522] "Shorter College"                              
[523] "Siena College"                                
[524] "Siena Heights College"                        
[525] "Simmons College"                              
[526] "Simpson College"                              
[527] "Sioux Falls College"                          
[528] "Skidmore College"                             
[529] "Smith College"                                
[530] "South Dakota State University"                
[531] "Southeast Missouri State University"          
[532] "Southeastern Oklahoma State Univ."            
[533] "Southern California College"                  
[534] "Southern Illinois University at Edwardsville" 
[535] "Southern Methodist University"                
[536] "Southwest Baptist University"                 
[537] "Southwest Missouri State University"          
[538] "Southwest State University"                   
[539] "Southwestern Adventist College"               
[540] "Southwestern College"                         
[541] "Southwestern University"                      
[542] "Spalding University"                          
[543] "Spelman College"                              
[544] "Spring Arbor College"                         
[545] "St. Bonaventure University"                   
[546] "St. John's College"                           
[547] "St. John Fisher College"                      
[548] "St. Lawrence University"                      
[549] "St. Martin's College"                         
[550] "St. Mary's College of California"             
[551] "St. Mary's College of Maryland"               
[552] "St. Mary's University of San Antonio"         
[553] "St. Norbert College"                          
[554] "St. Paul's College"                           
[555] "St. Thomas Aquinas College"                   
[556] "Stephens College"                             
[557] "Stetson University"                           
[558] "Stevens Institute of Technology"              
[559] "Stockton College of New Jersey"               
[560] "Stonehill College"                            
[561] "SUNY at Albany"                               
[562] "SUNY at Binghamton"                           
[563] "SUNY at Buffalo"                              
[564] "SUNY at Stony Brook"                          
[565] "SUNY College  at Brockport"                   
[566] "SUNY College  at Oswego"                      
[567] "SUNY College at Buffalo"                      
[568] "SUNY College at Cortland"                     
[569] "SUNY College at Fredonia"                     
[570] "SUNY College at Geneseo"                      
[571] "SUNY College at New Paltz"                    
[572] "SUNY College at Plattsburgh"                  
[573] "SUNY College at Potsdam"                      
[574] "SUNY College at Purchase"                     
[575] "Susquehanna University"                       
[576] "Sweet Briar College"                          
[577] "Syracuse University"                          
[578] "Tabor College"                                
[579] "Talladega College"                            
[580] "Taylor University"                            
[581] "Tennessee Wesleyan College"                   
[582] "Texas A&amp;M Univ. at College Station"           
[583] "Texas A&amp;M University at Galveston"            
[584] "Texas Christian University"                   
[585] "Texas Lutheran College"                       
[586] "Texas Southern University"                    
[587] "Texas Wesleyan University"                    
[588] "The Citadel"                                  
[589] "Thiel College"                                
[590] "Tiffin University"                            
[591] "Transylvania University"                      
[592] "Trenton State College"                        
[593] "Tri-State University"                         
[594] "Trinity College CT"                           
[595] "Trinity College DC"                           
[596] "Trinity College VT"                           
[597] "Trinity University"                           
[598] "Tulane University"                            
[599] "Tusculum College"                             
[600] "Tuskegee University"                          
[601] "Union College KY"                             
[602] "Union College NY"                             
[603] "Univ. of Wisconsin at OshKosh"                
[604] "University of Alabama at Birmingham"          
[605] "University of Arkansas at Fayetteville"       
[606] "University of California at Berkeley"         
[607] "University of California at Irvine"           
[608] "University of Central Florida"                
[609] "University of Charleston"                     
[610] "University of Chicago"                        
[611] "University of Cincinnati"                     
[612] "University of Connecticut at Storrs"          
[613] "University of Dallas"                         
[614] "University of Dayton"                         
[615] "University of Delaware"                       
[616] "University of Denver"                         
[617] "University of Detroit Mercy"                  
[618] "University of Dubuque"                        
[619] "University of Evansville"                     
[620] "University of Florida"                        
[621] "University of Georgia"                        
[622] "University of Hartford"                       
[623] "University of Hawaii at Manoa"                
[624] "University of Illinois - Urbana"              
[625] "University of Illinois at Chicago"            
[626] "University of Indianapolis"                   
[627] "University of Kansas"                         
[628] "University of La Verne"                       
[629] "University of Louisville"                     
[630] "University of Maine at Farmington"            
[631] "University of Maine at Machias"               
[632] "University of Maine at Presque Isle"          
[633] "University of Maryland at Baltimore County"   
[634] "University of Maryland at College Park"       
[635] "University of Massachusetts at Amherst"       
[636] "University of Massachusetts at Dartmouth"     
[637] "University of Miami"                          
[638] "University of Michigan at Ann Arbor"          
[639] "University of Minnesota at Duluth"            
[640] "University of Minnesota at Morris"            
[641] "University of Minnesota Twin Cities"          
[642] "University of Mississippi"                    
[643] "University of Missouri at Columbia"           
[644] "University of Missouri at Rolla"              
[645] "University of Missouri at Saint Louis"        
[646] "University of Mobile"                         
[647] "University of Montevallo"                     
[648] "University of Nebraska at Lincoln"            
[649] "University of New England"                    
[650] "University of New Hampshire"                  
[651] "University of North Carolina at Asheville"    
[652] "University of North Carolina at Chapel Hill"  
[653] "University of North Carolina at Charlotte"    
[654] "University of North Carolina at Greensboro"   
[655] "University of North Carolina at Wilmington"   
[656] "University of North Dakota"                   
[657] "University of North Florida"                  
[658] "University of North Texas"                    
[659] "University of Northern Colorado"              
[660] "University of Northern Iowa"                  
[661] "University of Notre Dame"                     
[662] "University of Oklahoma"                       
[663] "University of Oregon"                         
[664] "University of Pennsylvania"                   
[665] "University of Pittsburgh-Main Campus"         
[666] "University of Portland"                       
[667] "University of Puget Sound"                    
[668] "University of Rhode Island"                   
[669] "University of Richmond"                       
[670] "University of Rochester"                      
[671] "University of San Diego"                      
[672] "University of San Francisco"                  
[673] "University of Sci. and Arts of Oklahoma"      
[674] "University of Scranton"                       
[675] "University of South Carolina at Aiken"        
[676] "University of South Carolina at Columbia"     
[677] "University of South Florida"                  
[678] "University of Southern California"            
[679] "University of Southern Colorado"              
[680] "University of Southern Indiana"               
[681] "University of Southern Mississippi"           
[682] "University of St. Thomas MN"                  
[683] "University of St. Thomas TX"                  
[684] "University of Tennessee at Knoxville"         
[685] "University of Texas at Arlington"             
[686] "University of Texas at Austin"                
[687] "University of Texas at San Antonio"           
[688] "University of the Arts"                       
[689] "University of the Pacific"                    
[690] "University of the South"                      
[691] "University of Tulsa"                          
[692] "University of Utah"                           
[693] "University of Vermont"                        
[694] "University of Virginia"                       
[695] "University of Washington"                     
[696] "University of West Florida"                   
[697] "University of Wisconsin-Stout"                
[698] "University of Wisconsin-Superior"             
[699] "University of Wisconsin-Whitewater"           
[700] "University of Wisconsin at Green Bay"         
[701] "University of Wisconsin at Madison"           
[702] "University of Wisconsin at Milwaukee"         
[703] "University of Wyoming"                        
[704] "Upper Iowa University"                        
[705] "Ursinus College"                              
[706] "Ursuline College"                             
[707] "Valley City State University"                 
[708] "Valparaiso University"                        
[709] "Vanderbilt University"                        
[710] "Vassar College"                               
[711] "Villanova University"                         
[712] "Virginia Commonwealth University"             
[713] "Virginia State University"                    
[714] "Virginia Tech"                                
[715] "Virginia Union University"                    
[716] "Virginia Wesleyan College"                    
[717] "Viterbo College"                              
[718] "Voorhees College"                             
[719] "Wabash College"                               
[720] "Wagner College"                               
[721] "Wake Forest University"                       
[722] "Walsh University"                             
[723] "Warren Wilson College"                        
[724] "Wartburg College"                             
[725] "Washington and Jefferson College"             
[726] "Washington and Lee University"                
[727] "Washington College"                           
[728] "Washington State University"                  
[729] "Washington University"                        
[730] "Wayne State College"                          
[731] "Waynesburg College"                           
[732] "Webber College"                               
[733] "Webster University"                           
[734] "Wellesley College"                            
[735] "Wells College"                                
[736] "Wentworth Institute of Technology"            
[737] "Wesley College"                               
[738] "Wesleyan University"                          
[739] "West Chester University of Penn."             
[740] "West Liberty State College"                   
[741] "West Virginia Wesleyan College"               
[742] "Western Carolina University"                  
[743] "Western Maryland College"                     
[744] "Western Michigan University"                  
[745] "Western New England College"                  
[746] "Western State College of Colorado"            
[747] "Western Washington University"                
[748] "Westfield State College"                      
[749] "Westminster College MO"                       
[750] "Westminster College"                          
[751] "Westminster College of Salt Lake City"        
[752] "Westmont College"                             
[753] "Wheaton College IL"                           
[754] "Westminster College PA"                       
[755] "Wheeling Jesuit College"                      
[756] "Whitman College"                              
[757] "Whittier College"                             
[758] "Whitworth College"                            
[759] "Widener University"                           
[760] "Wilkes University"                            
[761] "Willamette University"                        
[762] "William Jewell College"                       
[763] "William Woods University"                     
[764] "Williams College"                             
[765] "Wilson College"                               
[766] "Wingate College"                              
[767] "Winona State University"                      
[768] "Winthrop University"                          
[769] "Wisconsin Lutheran College"                   
[770] "Wittenberg University"                        
[771] "Wofford College"                              
[772] "Worcester Polytechnic Institute"              
[773] "Worcester State College"                      
[774] "Xavier University"                            
[775] "Xavier University of Louisiana"               
[776] "Yale University"                              
[777] "York College of Pennsylvania"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(college)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Private        Apps           Accept          Enroll       Top10perc    
 No :212   Min.   :   81   Min.   :   72   Min.   :  35   Min.   : 1.00  
 Yes:565   1st Qu.:  776   1st Qu.:  604   1st Qu.: 242   1st Qu.:15.00  
           Median : 1558   Median : 1110   Median : 434   Median :23.00  
           Mean   : 3002   Mean   : 2019   Mean   : 780   Mean   :27.56  
           3rd Qu.: 3624   3rd Qu.: 2424   3rd Qu.: 902   3rd Qu.:35.00  
           Max.   :48094   Max.   :26330   Max.   :6392   Max.   :96.00  
   Top25perc      F.Undergrad     P.Undergrad         Outstate    
 Min.   :  9.0   Min.   :  139   Min.   :    1.0   Min.   : 2340  
 1st Qu.: 41.0   1st Qu.:  992   1st Qu.:   95.0   1st Qu.: 7320  
 Median : 54.0   Median : 1707   Median :  353.0   Median : 9990  
 Mean   : 55.8   Mean   : 3700   Mean   :  855.3   Mean   :10441  
 3rd Qu.: 69.0   3rd Qu.: 4005   3rd Qu.:  967.0   3rd Qu.:12925  
 Max.   :100.0   Max.   :31643   Max.   :21836.0   Max.   :21700  
   Room.Board       Books           Personal         PhD        
 Min.   :1780   Min.   :  96.0   Min.   : 250   Min.   :  8.00  
 1st Qu.:3597   1st Qu.: 470.0   1st Qu.: 850   1st Qu.: 62.00  
 Median :4200   Median : 500.0   Median :1200   Median : 75.00  
 Mean   :4358   Mean   : 549.4   Mean   :1341   Mean   : 72.66  
 3rd Qu.:5050   3rd Qu.: 600.0   3rd Qu.:1700   3rd Qu.: 85.00  
 Max.   :8124   Max.   :2340.0   Max.   :6800   Max.   :103.00  
    Terminal       S.F.Ratio      perc.alumni        Expend     
 Min.   : 24.0   Min.   : 2.50   Min.   : 0.00   Min.   : 3186  
 1st Qu.: 71.0   1st Qu.:11.50   1st Qu.:13.00   1st Qu.: 6751  
 Median : 82.0   Median :13.60   Median :21.00   Median : 8377  
 Mean   : 79.7   Mean   :14.09   Mean   :22.74   Mean   : 9660  
 3rd Qu.: 92.0   3rd Qu.:16.50   3rd Qu.:31.00   3rd Qu.:10830  
 Max.   :100.0   Max.   :39.80   Max.   :64.00   Max.   :56233  
   Grad.Rate     
 Min.   : 10.00  
 1st Qu.: 53.00  
 Median : 65.00  
 Mean   : 65.46  
 3rd Qu.: 78.00  
 Max.   :118.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(college[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="islr_files/figure-html/unnamed-chunk-2-25.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>?Boston</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<p>Linear regression is a useful tool for predicting a quantitative response <span class="math inline">\(Y\)</span> on the basis of a single predictor variable <span class="math inline">\(X\)</span> . It assumes that there is approximately a linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> .</p>
<p><span class="math inline">\(Y ≈ β_0 + β_1X\)</span> .</p>
<p>Patient survival rate may be approximately modeled as response to biomarker A quantity. Then we regress patient survival rate onto biomarker A quantity by fitting the model</p>
<p><span class="math inline">\(patient\_survival\_rate ≈ β_0 + β_1 * biomarker\_A\_quantity\)</span> .</p>
<p><span class="math inline">\(β_0\)</span> and <span class="math inline">\(β_1\)</span> are the intercept and slope terms, unknown constants. They are the model coefficients or parameters. These will be derived by the training data, then we may predict patient survival rate of a biomarker A quantity by</p>
<p><span class="math inline">\(\hat{y} = \hat{\beta_0} + \hat{\beta_1}x\)</span> ,</p>
<p>where <span class="math inline">\(\hat{y}\)</span> indicates a prediction of <span class="math inline">\(Y\)</span> on the basis of <span class="math inline">\(X = x\)</span>.</p>
<section id="estimating-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="estimating-coefficients">Estimating Coefficients</h3>
<p>In practice, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown. So we must use data to estimate the coefficients. Let</p>
<p><span class="math inline">\((x_1,y_1), (x_2,y_2),…, (x_n,y_n)\)</span></p>
<p>represent n observation pairs, each of which consists of a measurement of <span class="math inline">\(X\)</span> and a measurement of <span class="math inline">\(Y\)</span> . Our goal is to obtain coefficient estimates <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> such that the linear model fits the available data well—that is, so that <span class="math inline">\(y_i ≈ \hat{\beta_0} + \hat{\beta_1}x_i\)</span> for $i = 1, . . . , n$. In other words, we want to find an intercept <span class="math inline">\(\hat{\beta_0}\)</span> and a slope <span class="math inline">\(\hat{\beta_1}\)</span> such that the resulting line is as close as possible to the data points. There are a number of ways of measuring closeness. However, by far the most common approach involves minimizing the least squares criterion.</p>
<p>Let <span class="math inline">\(\hat{y_i} = \hat{\beta_0} + \hat{\beta_1}x_i\)</span> be the prediction for <span class="math inline">\(Y\)</span> based on the <span class="math inline">\(i\)</span>th value of <span class="math inline">\(X\)</span> . Then <span class="math inline">\(e_i = y_i − \hat{y_i}\)</span> represents the <span class="math inline">\(i\)</span> th residual—this is the difference between the <span class="math inline">\(i\)</span> th observed response value and the <span class="math inline">\(i\)</span> th response value that is predicted by our linear model. We define the residual sum of squares (RSS) as</p>
<p><span class="math inline">\(RSS=e^2_1 +e^2_2 +···+e^2_n\)</span> ,</p>
<p>or equivalently as</p>
<p><span class="math inline">\(RSS=(y_1−\hat{\beta_0}−\hat{\beta_1}x_1)^2+(y_2−\hat{\beta_0}−\hat{\beta_1}x_2)^2+···+(y_n−\hat{\beta_0}−\hat{\beta_1}x_n)^2\)</span>.</p>
<p>The least squares approach chooses <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> to minimize the RSS. Using some calculus, one can show that the minimizers are</p>
<p><span class="math inline">\(\hat{\beta_1}=\frac{\Sigma^n_{i=1}(x_i − \bar{x})(y_i − \bar{y})}{\Sigma^n_{i=1}(x_i - \bar{x})^2}\)</span> ,</p>
<p><span class="math inline">\(\hat{\beta_0} = \bar{y}-\hat{\beta_1}\bar{x}\)</span> ,</p>
<p>where <span class="math inline">\(\bar{y} = \frac{1}{n}\Sigma^n_{i=1}y_i\)</span> and <span class="math inline">\(\bar{x} = \frac{1}{n}\Sigma^n_{i=1}x_i\)</span> are the sample means. In other words, this defines the least squares coefficient estimates for simple linear regression.</p>
</section>
<section id="assessing-the-accuracy-of-the-coefficient-estimates" class="level3">
<h3 class="anchored" data-anchor-id="assessing-the-accuracy-of-the-coefficient-estimates">Assessing the Accuracy of the Coefficient Estimates</h3>
<p>We assume that the _true_ relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> takes the form <span class="math inline">\(Y = f(X) + \epsilon\)</span> for some unknown function $f$, where <span class="math inline">\(\epsilon\)</span> is a mean-zero random error term. If <span class="math inline">\(f\)</span> is to be approximated by a linear function, then we can write this relationship as</p>
<p><span class="math inline">\(Y = \beta_0 + \beta_1 X + \epsilon\)</span> .</p>
<p>Here <span class="math inline">\(\beta_0\)</span> is the intercept term—that is, the expected value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X = 0\)</span> , and <span class="math inline">\(\beta_1\)</span> is the slope—the average increase in <span class="math inline">\(Y\)</span> associated with a one-unit increase in <span class="math inline">\(X\)</span> . The error term is a catch-all for what we miss with this simple model: the true relationship is probably not linear, there may be other variables that cause variation in <span class="math inline">\(Y\)</span> , and there may be measurement error. We typically assume that the error term is independent of <span class="math inline">\(X\)</span> .</p>
<p>This model defines the <em>population regression line</em>, which is the best linear approximation to the true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> . The least squares regression coefficient estimates characterize the least squares line.</p>
<p>The true relationship is generally not known for real data, but the least squares line can always be computed using the coefficient estimates. In other words, in real applications, we have access to a set of observations from which we can compute the least squares line; however, the population regression line is unobserved.</p>
<p>A reasonable estimate of the population mean <span class="math inline">\(\hat{\mu} = \bar{y}\)</span> , is the sample mean, where <span class="math inline">\(\bar{y} = \frac{1}{n}\Sigma^n_{i=1}y_i\)</span> . In the same way, the unknown coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in linear regression define the population regression line. We seek to estimate these unknown coefficients using <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> . These coefficient estimates define the least squares line.</p>
<p>To quantify how accurate the sample mean <span class="math inline">\(\hat{\mu}\)</span> ’s estimation is of <span class="math inline">\(\mu\)</span> , we compute the standard error of <span class="math inline">\(SE(\hat{\mu})\)</span> .</p>
<p><span class="math inline">\(Var(\hat{\mu}) = SE(\hat{\mu})^2 = \frac{\sigma^2}{n}\)</span> ,</p>
<p>where <span class="math inline">\(\sigma\)</span> is the standard deviation of each of the realizations <span class="math inline">\(y_i\)</span> of <span class="math inline">\(Y\)</span> . This holds provided that the <span class="math inline">\(n\)</span> observations are uncorrelated. The standard error tells us the average amount that this estimate <span class="math inline">\(\hat{\mu}\)</span> differs from the actual value of <span class="math inline">\(\mu\)</span> . Also note, this deviation shrinks with <span class="math inline">\(n\)</span> —the more observations we have, the smaller the standard error of <span class="math inline">\(\hat{\mu}\)</span> . In a similar vein, we can wonder how close <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> are to the true values <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> . To compute the standard errors associated with <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> , we use the following formulas:</p>
<p><span class="math inline">\(SE(\hat{\beta_0})^2 = \sigma^2\big[\frac{1}{n} + \frac{\bar{x}^2}{\Sigma^n_{i=1}(x_i-\bar{x})^2}\big]\)</span> ,</p>
<p><span class="math inline">\(SE(\hat{\beta_1})^2 = \sigma^2\big[\frac{1}{n} + \frac{\sigma^2}{\Sigma^n_{i=1}(x_i-\bar{x})^2}\big]\)</span> ,</p>
<p>where <span class="math inline">\(\sigma^2 = Var(\epsilon)\)</span> . For these formulas to be strictly valid, we need to assume that the errors <span class="math inline">\(\epsilon_i\)</span> for each observation have common variance <span class="math inline">\(\sigma^2\)</span> and are uncorrelated. Notice in the formula that <span class="math inline">\(SE(\hat{\beta_1})\)</span> is smaller when the <span class="math inline">\(x_i\)</span> are more spread out; intuitively we have more <em>leverage</em> to estimate a slope when this is the case. We also see that <span class="math inline">\(SE(\hat{\beta_0})\)</span> would be the same as <span class="math inline">\(SE(\hat{\mu})\)</span> if <span class="math inline">\(\bar{x}\)</span> were zero (in which case <span class="math inline">\(\hat{\beta_0}\)</span> would be equal to <span class="math inline">\(\bar{y}\)</span> . In general, <span class="math inline">\(\sigma^2\)</span> is not known, but can be estimated from the data. This estimate of <span class="math inline">\(\sigma\)</span> is known as the <em>residual standard error</em> , and is given by <span class="math inline">\(RSE = \sqrt{RSS/(n-2)}\)</span> .</p>
<p>Standard errors can be used to compute <em>confidence intervals</em>. A 95% confidence interval is defined as a range of values such that with 95% probability, the range will contain the true unknown value of the parameter. The range is defined in terms of lower and upper limits computed from the sample of data. A 95% confidence interval has the following prop- erty: if we take repeated samples and construct the confidence interval for each sample, 95% of the intervals will contain the true unknown value of the parameter. For linear regression, the 95% confidence interval for <span class="math inline">\(\beta_1\)</span> approximately takes the form</p>
<p><span class="math inline">\(\hat{\beta_1} \pm 2 \cdot SE(\hat{\beta_1})\)</span></p>
<p>That is there is approximately a 95% chance that the interval</p>
<p><span class="math inline">\(\big[\hat{\beta_1} - 2 \cdot SE(\hat{\beta_1}), \hat{\beta_1} + 2 \cdot SE(\hat{\beta_1)}\big]\)</span></p>
<p>will contain the true value of <span class="math inline">\(\beta_1\)</span> . Approximately for several reasons. The equation relies on the assumption that the errors are Gaussian. Also, the factor of 2 in front of the <span class="math inline">\(SE(\hat{\beta_1})\)</span> term will vary slightly depending on the number of observations <span class="math inline">\(n\)</span> in the linear regression. To be precise, rather than the number 2, the equation should contain the 97.5% quantile of a t-distribution with <span class="math inline">\(n−2\)</span> degrees of freedom. Similarly, a confidence interval for <span class="math inline">\(\beta_0\)</span> approximately takes the form</p>
<p><span class="math inline">\(\hat{\beta_0} \pm 2 \cdot SE(\hat{\beta_0})\)</span> .</p>
<p>Standard errors can also be used to perform <em>hypothesis tests</em> on the coefficients. The most common hypothesis test involves testing the <em>null hypothesis</em> of</p>
<p><span class="math inline">\(H_0\)</span> : There is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></p>
<p>versus the alternative hypothesis</p>
<p><span class="math inline">\(H_a\)</span> : There is some relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> . Mathematically, this corresponds to testing</p>
<p><span class="math inline">\(H_0 : \beta_1 = 0\)</span></p>
<p>versus <span class="math inline">\(H_a : \beta_1 \neq 0\)</span> ,</p>
<p>since if <span class="math inline">\(\beta_1 =0\)</span> then the model reduces to <span class="math inline">\(Y = \beta_0+\epsilon\)</span> ,and <span class="math inline">\(X\)</span> is not associated with <span class="math inline">\(Y\)</span> . To test the null hypothesis, we need to determine whether <span class="math inline">\(\hat{\beta_1}\)</span> , our estimate for <span class="math inline">\(\beta_1\)</span> , is sufficiently far from zero that we can be confident that <span class="math inline">\(\beta_1\)</span> is non-zero. How far is far enough? This of course depends on the accuracy of <span class="math inline">\(\hat{\beta_1}\)</span> —that is, it depends on <span class="math inline">\(SE(\hat{\beta}_1)\)</span> . If <span class="math inline">\(SE(\hat{\beta}_1)\)</span> is small, then even relatively small values of <span class="math inline">\(\hat{\beta}_1\)</span> may provide strong evidence that <span class="math inline">\(\beta_1 \neq 0\)</span> , and hence that there is a relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> . In contrast, if <span class="math inline">\(SE(\hat{\beta}_1)\)</span> is large, then <span class="math inline">\(\hat{\beta}_1\)</span> must be large in absolute value in order for us to reject the null hypothesis. In practice, we compute a t-statistic, given by</p>
<p><span class="math inline">\(t = \frac{\hat{\beta}_1 − 0} {SE(\hat{\beta}_1 )}\)</span> ,</p>
<p>which measures the number of standard deviations that <span class="math inline">\(\hat{\beta}_1\)</span> is away from 0. If there really is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> , then we expect a t-distribution with <span class="math inline">\(n − 2\)</span> degrees of freedom. The t-distribution has a bell shape and for values of <span class="math inline">\(n\)</span> greater than approximately 30 it is quite similar to the standard normal distribution. Consequently, it is a simple matter to compute the probability of observing any number equal to <span class="math inline">\(|t|\)</span> or larger in absolute value, assuming <span class="math inline">\(\beta_1 = 0\)</span> . We call this probability the <em>p-value</em>. Roughly speaking, we interpret the <em>p-value</em> as follows: a small <em>p-value</em> indicates that it is unlikely to observe such a substantial association between the predictor and the response due to chance, in the absence of any real association between the predictor and the response. Hence, if we see a small <em>p-value</em>, then we can infer that there is an association between the predictor and the response. We <em>reject the null hypothesis</em>—that is, we declare a relationship to exist between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> —if the <em>p-value</em> is small enough. Typical <em>p-value</em> cutoffs for rejecting the null hypothesis are 5% or 1%. When n = 30, these correspond to t-statistics of around 2 and 2.75, respectively.</p>
<p>## Assessing the Accuracy of the Model</p>
<p>Once we have rejected the null hypothesis (3.12) in favor of the alternative hypothesis (3.13), it is natural to want to quantify the extent to which the model fits the data. The quality of a linear regression fit is typically assessed using two related quantities: the residual standard error (RSE) and the R2 statistic. R2</p>
<p>Table 3.2 displays the RSE, the R2 statistic, and the F-statistic (to be described in Section 3.2.2) for the linear regression of number of units sold on TV advertising budget.</p>
<p>Residual Standard Error</p>
<p>Recall from the model (3.5) that associated with each observation is an error term ε. Due to the presence of these error terms, even if we knew the true regression line (i.e.&nbsp;even if β0 and β1 were known), we would not be able to perfectly predict Y from X. The RSE is an estimate of the standard deviation of ε. Roughly speaking, it is the average amount that the response will deviate from the true regression line. It is computed using the formula</p>
<p>􏰘 1 􏰙􏰚􏰚 1 􏰓n</p>
<p>RSE= n−2RSS=􏰛n−2 (yi −yˆi)2. (3.15)</p>
<p>i=1</p>
<p>Note that RSS was defined in Section 3.1.1, and is given by the formula</p>
<p>􏰓n i=1</p>
<p>In the case of the advertising data, we see from the linear regression output in Table 3.2 that the RSE is 3.26. In other words, actual sales in each market deviate from the true regression line by approximately 3,260 units, on average. Another way to think about this is that even if the model were correct and the true values of the unknown coefficients β0 and β1 were known exactly, any prediction of sales on the basis of TV advertising would still be off by about 3,260 units on average. Of course, whether or not 3,260 units is an acceptable prediction error depends on the problem context. In the advertising data set, the mean value of sales over all markets is approximately 14,000 units, and so the percentage error is 3,260/14,000 = 23 %.</p>
<p>The RSE is considered a measure of the lack of fit of the model (3.5) to the data. If the predictions obtained using the model are very close to the true outcome values—that is, if yˆi ≈ yi for i = 1, . . . , n—then (3.15) will be small, and we can conclude that the model fits the data very well. On the other hand, if yˆi is very far from yi for one or more observations, then the RSE may be quite large, indicating that the model doesn’t fit the data well.</p>
<p>R2 Statistic</p>
<p>The RSE provides an absolute measure of lack of fit of the model (3.5) to the data. But since it is measured in the units of Y , it is not always clear what constitutes a good RSE. The R2 statistic provides an alternative measure of fit. It takes the form of a proportion—the proportion of variance explained—and so it always takes on a value between 0 and 1, and is independent of the scale of Y .</p>
<p>To calculate R2, we use the formula</p>
<p>R2 = TSS − RSS = 1 − RSS (3.17)</p>
<p>where TSS = 􏰎(yi − y ̄)2 is the total sum of squares, and RSS is defined total sum of in (3.16). TSS measures the total variance in the response Y , and can be squares thought of as the amount of variability inherent in the response before the</p>
<p>regression is performed. In contrast, RSS measures the amount of variability</p>
<p>TSS TSS</p>
<p>that is left unexplained after performing the regression. Hence, TSS − RSS measures the amount of variability in the response that is explained (or removed) by performing the regression, and R2 measures the proportion of variability in Y that can be explained using X. An R2 statistic that is close to 1 indicates that a large proportion of the variability in the response is explained by the regression. A number near 0 indicates that the regression does not explain much of the variability in the response; this might occur because the linear model is wrong, or the error variance σ2 is high, or both. In Table 3.2, the R2 was 0.61, and so just under two-thirds of the variability in sales is explained by a linear regression on TV.</p>
<p>The R2 statistic (3.17) has an interpretational advantage over the RSE (3.15), since unlike the RSE, it always lies between 0 and 1. However, it can still be challenging to determine what is a good R2 value, and in general, this will depend on the application. For instance, in certain problems in physics, we may know that the data truly comes from a linear model with a small residual error. In this case, we would expect to see an R2 value that is extremely close to 1, and a substantially smaller R2 value might indicate a serious problem with the experiment in which the data were generated. On the other hand, in typical applications in biology, psychology, marketing, and other domains, the linear model (3.5) is at best an extremely rough approximation to the data, and residual errors due to other unmeasured factors are often very large. In this setting, we would expect only a very small proportion of the variance in the response to be explained by the predictor, and an R2 value well below 0.1 might be more realistic!</p>
<p>The R2 statistic is a measure of the linear relationship between X and Y . Recall that correlation, define􏰎d as</p>
<p>ni=1(xi − x)(yi − y)</p>
<p>Cor(X, Y ) = 􏰔􏰎ni=1(xi − x)2􏰔􏰎ni=1(yi − y)2 , (3.18)</p>
<p>is also a measure of the linear relationship between X and Y .5 This sug- gests that we might be able to use r = Cor(X, Y ) instead of R2 in order to assess the fit of the linear model. In fact, it can be shown that in the simple linear regression setting, R2 = r2. In other words, the squared correlation and the R2 statistic are identical. However, in the next section we will discuss the multiple linear regression problem, in which we use several pre- dictors simultaneously to predict the response. The concept of correlation between the predictors and the response does not extend automatically to this setting, since correlation quantifies the association between a single pair of variables rather than between a larger number of variables. We will see that R2 fills this role.</p>
<p>Multiple Linear Regression</p>
<p>Simple linear regression is a useful approach for predicting a response on the basis of a single predictor variable. However, in practice we often have more than one predictor. For example, in the Advertising data, we have examined the relationship between sales and TV advertising. We also have data for the amount of money spent advertising on the radio and in newspapers, and we may want to know whether either of these two media is associated with sales. How can we extend our analysis of the advertising data in order to accommodate these two additional predictors?</p>
<p>One option is to run three separate simple linear regressions, each of which uses a different advertising medium as a predictor. For instance, we can fit a simple linear regression to predict sales on the basis of the amount spent on radio advertisements. Results are shown in Table 3.3 (top table). We find that a $1,000 increase in spending on radio advertising is associated with an increase in sales of around 203 units. Table 3.3 (bottom table) contains the least squares coefficients for a simple linear regression of sales onto newspaper advertising budget. A $1,000 increase in newspaper advertising budget is associated with an increase in sales of approximately 55 units.</p>
<p>However, the approach of fitting a separate simple linear regression model for each predictor is not entirely satisfactory. First of all, it is unclear how to make a single prediction of sales given the three advertising media budgets, since each of the budgets is associated with a separate regression equation. Second, each of the three regression equations ignores the other two media in forming estimates for the regression coefficients. We will see shortly that if the media budgets are correlated with each other in the 200 markets in our data set, then this can lead to very misleading estimates of the association between each media budget and sales.</p>
<p>Instead of fitting a separate simple linear regression model for each pre- dictor, a better approach is to extend the simple linear regression model (3.5) so that it can directly accommodate multiple predictors. We can do this by giving each predictor a separate slope coefficient in a single model. In general, suppose that we have p distinct predictors. Then the multiple linear regression model takes the form</p>
<p>Y =β0 +β1X1 +β2X2 +···+βpXp +ε, (3.19)</p>
<p>where Xj represents the jth predictor and βj quantifies the association between that variable and the response. We interpret βj as the average effect on Y of a one unit increase in Xj, holding all other predictors fixed. In the advertising example, (3.19) becomes</p>
<p>sales=β0 +β1 ×TV+β2 ×radio+β3 ×newspaper+ε. (3.20) 3.2.1 Estimating the Regression Coefficients</p>
<p>As was the case in the simple linear regression setting, the regression coef- ficients β0, β1, . . . , βp in (3.19) are unknown, and must be estimated. Given estimates βˆ0, βˆ1, . . . , βˆp, we can make predictions using the formula</p>
<p>yˆ = βˆ0 + βˆ1x1 + βˆ2x2 + ··· + βˆpxp. (3.21)</p>
<p>The parameters are estimated using the same least squares approach that we saw in the context of simple linear regression. We choose β0, β1, . . . , βp to minimize the sum of squared residuals</p>
<p>RSS = =</p>
<p>􏰓n i=1</p>
<p>􏰓n i=1</p>
<p>(yi−yˆi)2</p>
<p>(yi −βˆ0 −βˆ1xi1 −βˆ2xi2 −···−βˆpxip)2.</p>
<p>(3.22)</p>
<p>The values βˆ0 , βˆ1 , . . . , βˆp that minimize (3.22) are the multiple least squares regression coefficient estimates. Unlike the simple linear regression esti- mates given in (3.4), the multiple regression coefficient estimates have somewhat complicated forms that are most easily represented using ma- trix algebra. For this reason, we do not provide them here. Any statistical software package can be used to compute these coefficient estimates, and later in this chapter we will show how this can be done in R. Figure 3.4 illustrates an example of the least squares fit to a toy data set with p = 2 predictors.</p>
<p>Table 3.4 displays the multiple regression coefficient estimates when TV, radio, and newspaper advertising budgets are used to predict product sales using the Advertising data. We interpret these results as follows: for a given amount of TV and newspaper advertising, spending an additional $1,000 on radio advertising is associated with approximately 189 units of additional sales. Comparing these coefficient estimates to those displayed in Tables 3.1 and 3.3, we notice that the multiple regression coefficient estimates for TV and radio are pretty similar to the simple linear regression coefficient estimates. However, while the newspaper regression coefficient estimate in Table 3.3 was significantly non-zero, the coefficient estimate for newspaper in the multiple regression model is close to zero, and the corresponding p- value is no longer significant, with a value around 0.86. This illustrates that the simple and multiple regression coefficients can be quite different. This difference stems from the fact that in the simple regression case, the slope term represents the average increase in product sales associated with a $1,000 increase in newspaper advertising, ignoring other predictors such as TV and radio. By contrast, in the multiple regression setting, the coefficient for newspaper represents the average increase in product sales associated with increasing newspaper spending by $1,000 while holding TV and radio fixed.</p>
<p>Intercept</p>
<p>TV</p>
<p>radio</p>
<p>newspaper</p>
<p>Coefficient 2.939 0.046 0.189 −0.001</p>
<p>Std. error 0.3119 0.0014 0.0086 0.0059</p>
<p>t-statistic 9.42 32.81 21.89 −0.18</p>
<p>p-value &lt; 0.0001 &lt; 0.0001 &lt; 0.0001</p>
<p>0.8599</p>
<p>TABLE 3.4. For the Advertising data, least squares coefficient estimates of the multiple linear regression of number of units sold on TV, radio, and newspaper advertising budgets.</p>
<p>Does it make sense for the multiple regression to suggest no relationship between sales and newspaper while the simple linear regression implies the opposite? In fact it does. Consider the correlation matrix for the three predictor variables and response variable, displayed in Table 3.5. Notice that the correlation between radio and newspaper is 0.35. This indicates that markets with high newspaper advertising tend to also have high ra- dio advertising. Now suppose that the multiple regression is correct and newspaper advertising is not associated with sales, but radio advertising is associated with sales. Then in markets where we spend more on radio our sales will tend to be higher, and as our correlation matrix shows, we also tend to spend more on newspaper advertising in those same mar- kets. Hence, in a simple linear regression which only examines sales versus newspaper, we will observe that higher values of newspaper tend to be as- sociated with higher values of sales, even though newspaper advertising is not directly associated with sales. So newspaper advertising is a surrogate for radio advertising; newspaper gets “credit” for the association between radio on sales.</p>
<p>This slightly counterintuitive result is very common in many real life situations. Consider an absurd example to illustrate the point. Running a regression of shark attacks versus ice cream sales for data collected at a given beach community over a period of time would show a positive relationship, similar to that seen between sales and newspaper. Of course no one has (yet) suggested that ice creams should be banned at beaches to reduce shark attacks. In reality, higher temperatures cause more people to visit the beach, which in turn results in more ice cream sales and more shark attacks. A multiple regression of shark attacks onto ice cream sales and temperature reveals that, as intuition implies, ice cream sales is no longer a significant predictor after adjusting for temperature.</p>
<p>3.2.2 Some Important Questions</p>
<p>When we perform multiple linear regression, we usually are interested in answering a few important questions.</p>
<p>1. Is at least one of the predictors X1,X2,…,Xp useful in predicting the response?</p>
<p>2. Do all the predictors help to explain Y , or is only a subset of the predictors useful?</p>
<p>3. How well does the model fit the data?</p>
<p>4. Given a set of predictor values, what response value should we predict,</p>
<p>and how accurate is our prediction?</p>
<p>We now address each of these questions in turn.</p>
<p>One: Is There a Relationship Between the Response and Predictors?</p>
<p>Recall that in the simple linear regression setting, in order to determine whether there is a relationship between the response and the predictor we can simply check whether β1 = 0. In the multiple regression setting with p predictors, we need to ask whether all of the regression coefficients are zero, i.e.&nbsp;whether β1 = β2 = ··· = βp = 0. As in the simple linear regression setting, we use a hypothesis test to answer this question. We test the null hypothesis,</p>
<p>H0 :β1 =β2 =···=βp =0</p>
<p>versus the alternative</p>
<p>Ha : at least one βj is non-zero.</p>
<p>This hypothesis test is performed by computing the F-statistic,</p>
<p>TV</p>
<p>radio</p>
<p>newspaper</p>
<p>sales</p>
<p>1.0000 0.3541</p>
<p>1.0000 0.2283</p>
<p>3.2 Multiple Linear Regression 75</p>
<p>0.5762 1.0000</p>
<p>F = (TSS − RSS)/p , (3.23) RSS/(n−p−1)</p>
<p>w􏰎here, as with simple linear regression, TSS = 􏰎(yi − y ̄)2 and RSS = (yi −yˆi)2. If the linear model assumptions are correct, one can show that</p>
<p>E{RSS/(n − p − 1)} = σ2 and that, provided H0 is true,</p>
<p>E{(TSS − RSS)/p} = σ2.</p>
<p>Hence, when there is no relationship between the response and predictors, one would expect the F -statistic to take on a value close to 1. On the other hand, if Ha is true, then E{(TSS − RSS)/p} &gt; σ2, so we expect F to be greater than 1.</p>
<p>The F-statistic for the multiple linear regression model obtained by re- gressing sales onto radio, TV, and newspaper is shown in Table 3.6. In this example the F-statistic is 570. Since this is far larger than 1, it provides compelling evidence against the null hypothesis H0. In other words, the large F-statistic suggests that at least one of the advertising media must be related to sales. However, what if the F -statistic had been closer to 1? How large does the F-statistic need to be before we can reject H0 and conclude that there is a relationship? It turns out that the answer depends on the values of n and p.&nbsp;When n is large, an F-statistic that is just a little larger than 1 might still provide evidence against H0. In contrast, a larger F-statistic is needed to reject H0 if n is small. When H0 is true and the errors εi have a normal distribution, the F-statistic follows an F-distribution.6 For any given value of n and p, any statistical software package can be used to compute the p-value associated with the F -statistic using this distribution. Based on this p-value, we can determine whether or not to reject H0. For the advertising data, the p-value associated with the F -statistic in Table 3.6 is essentially zero, so we have extremely strong evidence that at least one of the media is associated with increased sales.</p>
<p>In (3.23) we are testing H0 that all the coefficients are zero. Sometimes we want to test that a particular subset of q of the coefficients are zero. This corresponds to a null hypothesis</p>
<p>H0 : βp−q+1 =βp−q+2 =···=βp =0,</p>
<p>where for convenience we have put the variables chosen for omission at the end of the list. In this case we fit a second model that uses all the variables except those last q. Suppose that the residual sum of squares for that model is RSS0. Then the appropriate F-statistic is</p>
<p>F = (RSS0 − RSS)/q . (3.24) RSS/(n−p−1)</p>
<p>Notice that in Table 3.4, for each individual predictor a t-statistic and a p-value were reported. These provide information about whether each individual predictor is related to the response, after adjusting for the other predictors. It turns out that each of these is exactly equivalent7 to the F- test that omits that single variable from the model, leaving all the others in—i.e.&nbsp;q=1 in (3.24). So it reports the partial effect of adding that variable to the model. For instance, as we discussed earlier, these p-values indicate that TV and radio are related to sales, but that there is no evidence that newspaper is associated with sales, when TV and radio are held fixed.</p>
<p>Given these individual p-values for each variable, why do we need to look at the overall F-statistic? After all, it seems likely that if any one of the p-values for the individual variables is very small, then at least one of the predictors is related to the response. However, this logic is flawed, especially when the number of predictors p is large.</p>
<p>For instance, consider an example in which p = 100 and H0 : β1 = β2 = · · · = βp = 0 is true, so no variable is truly associated with the response. In this situation, about 5% of the p-values associated with each variable (of the type shown in Table 3.4) will be below 0.05 by chance. In other words, we expect to see approximately five small p-values even in the absence of any true association between the predictors and the response.8 In fact, it is likely that we will observe at least one p-value below 0.05 by chance! Hence, if we use the individual t-statistics and associated p-values in order to decide whether or not there is any association between the variables and the response, there is a very high chance that we will incorrectly conclude that there is a relationship. However, the F-statistic does not suffer from this problem because it adjusts for the number of predictors. Hence, if H0 is true, there is only a 5% chance that the F-statistic will result in a p- value below 0.05, regardless of the number of predictors or the number of observations.</p>
<p>The approach of using an F-statistic to test for any association between the predictors and the response works when p is relatively small, and cer- tainly small compared to n.&nbsp;However, sometimes we have a very large num- ber of variables. If p &gt; n then there are more coefficients βj to estimate than observations from which to estimate them. In this case we cannot even fit the multiple linear regression model using least squares, so the F- statistic cannot be used, and neither can most of the other concepts that we have seen so far in this chapter. When p is large, some of the approaches discussed in the next section, such as forward selection, can be used. This high-dimensional setting is discussed in greater detail in Chapter 6.</p>
<p>Two: Deciding on Important Variables</p>
<p>As discussed in the previous section, the first step in a multiple regression analysis is to compute the F-statistic and to examine the associated p- value. If we conclude on the basis of that p-value that at least one of the predictors is related to the response, then it is natural to wonder which are the guilty ones! We could look at the individual p-values as in Table 3.4, but as discussed (and as further explored in Chapter 13), if p is large we are likely to make some false discoveries.</p>
<p>It is possible that all of the predictors are associated with the response, but it is more often the case that the response is only associated with a subset of the predictors. The task of determining which predictors are associated with the response, in order to fit a single model involving only those predictors, is referred to as variable selection. The variable selection problem is studied extensively in Chapter 6, and so here we will provide only a brief outline of some classical approaches.</p>
<p>Ideally, we would like to perform variable selection by trying out a lot of different models, each containing a different subset of the predictors. For instance, if p = 2, then we can consider four models: (1) a model contain- ing no variables, (2) a model containing X1 only, (3) a model containing X2 only, and (4) a model containing both X1 and X2. We can then se- lect the best model out of all of the models that we have considered. How do we determine which model is best? Various statistics can be used to judge the quality of a model. These include Mallow’s Cp, Akaike informa- tion criterion (AIC), Bayesian information criterion (BIC), and adjusted R2. These are discussed in more detail in Chapter 6. We can also deter- mine which model is best by plotting various model outputs, such as the residuals, in order to search for patterns.</p>
<p>Unfortunately, there are a total of 2p models that contain subsets of p variables. This means that even for moderate p, trying out every possible subsetofthepredictorsisinfeasible.Forinstance,wesawthatifp=2,then there are 22 = 4 models to consider. But if p = 30, then we must consider 230 = 1,073,741,824 models! This is not practical. Therefore, unless p is very small, we cannot consider all 2p models, and instead we need an automated</p>
<p>high- dimensional and efficient approach to choose a smaller set of models to consider. There are three classical approaches for this task:</p>
<p>• Forward selection. We begin with the null model—a model that con- tains an intercept but no predictors. We then fit p simple linear re- gressions and add to the null model the variable that results in the lowest RSS. We then add to that model the variable that results in the lowest RSS for the new two-variable model. This approach is continued until some stopping rule is satisfied.</p>
<p>• Backward selection. We start with all variables in the model, and remove the variable with the largest p-value—that is, the variable that is the least statistically significant. The new (p − 1)-variable model is fit, and the variable with the largest p-value is removed. This procedure continues until a stopping rule is reached. For instance, we may stop when all remaining variables have a p-value below some threshold.</p>
<p>• Mixed selection. This is a combination of forward and backward se- lection. We start with no variables in the model, and as with forward selection, we add the variable that provides the best fit. We con- tinue to add variables one-by-one. Of course, as we noted with the Advertising example, the p-values for variables can become larger as new predictors are added to the model. Hence, if at any point the p-value for one of the variables in the model rises above a certain threshold, then we remove that variable from the model. We con- tinue to perform these forward and backward steps until all variables in the model have a sufficiently low p-value, and all variables outside the model would have a large p-value if added to the model.</p>
<p>Backward selection cannot be used if p &gt; n, while forward selection can always be used. Forward selection is a greedy approach, and might include variables early that later become redundant. Mixed selection can remedy this.</p>
<p>Three: Model Fit</p>
<p>Two of the most common numerical measures of model fit are the RSE and R2, the fraction of variance explained. These quantities are computed and interpreted in the same fashion as for simple linear regression.</p>
<p>Recall that in simple regression, R2 is the square of the correlation of the response and the variable. In multiple linear regression, it turns out that it equals Cor(Y, Yˆ )2, the square of the correlation between the response and the fitted linear model; in fact one property of the fitted linear model is that it maximizes this correlation among all possible linear models.</p>
<p>An R2 value close to 1 indicates that the model explains a large portion of the variance in the response variable. As an example, we saw in Table 3.6</p>
<p>forward selection null model</p>
<p>backward selection</p>
<p>mixed selection</p>
<p>3.2 Multiple Linear Regression 79</p>
<p>80 3. Linear Regression</p>
<p>that for the Advertising data, the model that uses all three advertising me- dia to predict sales has an R2 of 0.8972. On the other hand, the model that uses only TV and radio to predict sales has an R2 value of 0.89719. In other words, there is a small increase in R2 if we include newspaper advertising in the model that already contains TV and radio advertising, even though we saw earlier that the p-value for newspaper advertising in Table 3.4 is not significant. It turns out that R2 will always increase when more variables are added to the model, even if those variables are only weakly associated with the response. This is due to the fact that adding another variable always results in a decrease in the residual sum of squares on the training data (though not necessarily the testing data). Thus, the R2 statistic, which is also computed on the training data, must increase. The fact that adding newspaper advertising to the model containing only TV and radio advertising leads to just a tiny increase in R2 provides addi- tional evidence that newspaper can be dropped from the model. Essentially, newspaper provides no real improvement in the model fit to the training samples, and its inclusion will likely lead to poor results on independent test samples due to overfitting.</p>
<p>By contrast, the model containing only TV as a predictor had an R2 of 0.61 (Table 3.2). Adding radio to the model leads to a substantial improve- ment in R2. This implies that a model that uses TV and radio expenditures to predict sales is substantially better than one that uses only TV advertis- ing. We could further quantify this improvement by looking at the p-value for the radio coefficient in a model that contains only TV and radio as predictors.</p>
<p>The model that contains only TV and radio as predictors has an RSE of 1.681, and the model that also contains newspaper as a predictor has an RSE of 1.686 (Table 3.6). In contrast, the model that contains only TV has an RSE of 3.26 (Table 3.2). This corroborates our previous conclusion that a model that uses TV and radio expenditures to predict sales is much more accurate (on the training data) than one that only uses TV spending. Furthermore, given that TV and radio expenditures are used as predictors, there is no point in also using newspaper spending as a predictor in the model. The observant reader may wonder how RSE can increase when newspaper is added to the model given that RSS must decrease. In general RSE is defined as 􏰘 1</p>
<p>RSE = n − p − 1 RSS, (3.25)</p>
<p>which simplifies to (3.15) for a simple linear regression. Thus, models with more variables can have higher RSE if the decrease in RSS is small relative to the increase in p.</p>
<p>In addition to looking at the RSE and R2 statistics just discussed, it can be useful to plot the data. Graphical summaries can reveal problems with a model that are not visible from numerical statistics. For example, Figure 3.5 displays a three-dimensional plot of TV and radio versus sales. We see that some observations lie above and some observations lie below the least squares regression plane. In particular, the linear model seems to overestimate sales for instances in which most of the advertising money was spent exclusively on either TV or radio. It underestimates sales for instances where the budget was split between the two media. This pro- nouncednon-linearpatternsuggestsasynergyorinteractioneffectbetween the advertising media, whereby combining the media together results in a bigger boost to sales than using any single medium. In Section 3.3.2, we will discuss extending the linear model to accommodate such synergistic effects through the use of interaction terms.</p>
<p>Four: Predictions</p>
<p>Once we have fit the multiple regression model, it is straightforward to apply (3.21) in order to predict the response Y on the basis of a set of values for the predictors X1 , X2 , . . . , Xp . However, there are three sorts of uncertainty associated with this prediction.</p>
<p>1. The coefficient estimates βˆ0, βˆ1, . . . , βˆp are estimates for β0, β1, . . . , βp. That is, the least squares plane</p>
<p>Yˆ = βˆ 0 + βˆ 1 X 1 + · · · + βˆ p X p</p>
<p>2.</p>
<p>3.</p>
<p>is only an estimate for the true population regression plane f(X)=β0 +β1X1 +···+βpXp.</p>
<p>The inaccuracy in the coefficient estimates is related to the reducible error from Chapter 2. We can compute a confidence interval in order to determine how close Yˆ will be to f(X).</p>
<p>Of course, in practice assuming a linear model for f(X) is almost always an approximation of reality, so there is an additional source of potentially reducible error which we call model bias. So when we use a linear model, we are in fact estimating the best linear approximation to the true surface. However, here we will ignore this discrepancy, and operate as if the linear model were correct.</p>
<p>Even if we knew f(X)—that is, even if we knew the true values for β0,β1,…,βp—the response value cannot be predicted perfectly because of the random error ε in the model (3.20). In Chapter 2, we referred to this as the irreducible error. How much will Y vary from Yˆ? We use prediction intervals to answer this question. Prediction intervals are always wider than confidence intervals, because they incorporate both the error in the estimate for f(X) (the reducible error) and the uncertainty as to how much an individual point will differ from the population regression plane (the irreducible error).</p>
<p>We use a confidence interval to quantify the uncertainty surrounding the average sales over a large number of cities. For example, given that $100,000 is spent on TV advertising and $20,000 is spent on radio advertising in each city, the 95 % confidence interval is [10,985, 11,528]. We interpret this to mean that 95 % of intervals of this form will contain the true value of f(X).9 On the other hand, a prediction interval can be used to quantify the uncertainty surrounding sales for a particular city. Given that $100,000 is spent on TV advertising and $20,000 is spent on radio advertising in that city the 95% prediction interval is [7,930, 14,580]. We interpret this to mean that 95 % of intervals of this form will contain the true value of Y for this city. Note that both intervals are centered at 11,256, but that the prediction interval is substantially wider than the confidence interval, reflecting the increased uncertainty about sales for a given city in comparison to the average sales over many locations.</p>
<p>Other Considerations in the Regression Model</p>
<p>3.3.1 Qualitative Predictors</p>
<p>In our discussion so far, we have assumed that all variables in our linear regression model are quantitative. But in practice, this is not necessarily the case; often some predictors are qualitative.</p>
<p>For example, the Credit data set displayed in Figure 3.6 records variables for a number of credit card holders. The response is balance (average credit card debt for each individual) and there are several quantitative predictors: age, cards (number of credit cards), education (years of education), income (in thousands of dollars), limit (credit limit), and rating (credit rating). Each panel of Figure 3.6 is a scatterplot for a pair of variables whose iden- tities are given by the corresponding row and column labels. For example, the scatterplot directly to the right of the word “Balance” depicts balance versus age, while the plot directly to the right of “Age” corresponds to age versus cards. In addition to these quantitative variables, we also have four qualitative variables: own (house ownership), student (student status), status (marital status), and region (East, West or South).</p>
<p>Predictors with Only Two Levels</p>
<p>Suppose that we wish to investigate differences in credit card balance be-</p>
<p>tween those who own a house and those who don’t, ignoring the other vari-</p>
<p>ables for the moment. If a qualitative predictor (also known as a factor)</p>
<p>only has two levels, or possible values, then incorporating it into a regres- sionmodelisverysimple.Wesimplycreateanindicatorordummyvariable dummy that takes on two possible numerical values.10 For example, based on the</p>
<p>own variable, we can create a new variable that takes the form</p>
<p>xi = 􏰜1 if ith person owns a house (3.26)</p>
<p>0 if ith person does not own a house,</p>
<p>and use this variable as a predictor in the regression equation. This results</p>
<p>in the model</p>
<p>yi =β0+β1xi+εi =􏰜β0+β1+εi ifithpersonownsahouse (3.27)</p>
<p>β0 + εi if ith person does not.</p>
<p>Now β0 can be interpreted as the average credit card balance among those who do not own, β0 + β1 as the average credit card balance among those who do own their house, and β1 as the average difference in credit card balance between owners and non-owners.</p>
<p>Table 3.7 displays the coefficient estimates and other information asso- ciated with the model (3.27). The average credit card debt for non-owners is estimated to be $509.80, whereas owners are estimated to carry $19.73 in additional debt for a total of $509.80 + $19.73 = $529.53. However, we notice that the p-value for the dummy variable is very high. This indicates that there is no statistical evidence of a difference in average credit card balance based on house ownership.</p>
<p>The decision to code owners as 1 and non-owners as 0 in (3.27) is ar- bitrary, and has no effect on the regression fit, but does alter the inter- pretation of the coefficients. If we had coded non-owners as 1 and own- ers as 0, then the estimates for β0 and β1 would have been 529.53 and −19.73, respectively, leading once again to a prediction of credit card debt of $529.53 − $19.73 = $509.80 for non-owners and a prediction of $529.53 for owners. Alternatively, instead of a 0/1 coding scheme, we could create a dummy variable</p>
<p>xi = 􏰜1 if ith person owns a house</p>
<p>−1 if ith person does not own a house</p>
<p>and use this variable in the regression equation. This results in the model yi =β0+β1xi+εi =􏰜β0+β1+εi ifithpersonownsahouse</p>
<p>β0 − β1 + εi if ith person does not own a house.</p>
<p>Now β0 can be interpreted as the overall average credit card balance (ig- noring the house ownership effect), and β1 is the amount by which house owners and non-owners have credit card balances that are above and below the average, respectively. In this example, the estimate for β0 is $519.665, halfway between the non-owner and owner averages of $509.80 and $529.53. The estimate for β1 is $9.865, which is half of $19.73, the average difference between owners and non-owners. It is important to note that the final pre- dictions for the credit balances of owners and non-owners will be identical regardless of the coding scheme used. The only difference is in the way that the coefficients are interpreted.</p>
<p>Qualitative Predictors with More than Two Levels</p>
<p>When a qualitative predictor has more than two levels, a single dummy variable cannot represent all possible values. In this situation, we can create additional dummy variables. For example, for the region variable we create two dummy variables. The first could be</p>
<p>xi1 = 􏰜1 0</p>
<p>and the second could be</p>
<p>xi2 = 􏰜1 0</p>
<p>if ith person is from the South</p>
<p>if ith person is not from the South,</p>
<p>if ith person is from the West</p>
<p>if ith person is not from the West.</p>
<p>(3.28)</p>
<p>(3.29)</p>
<p>Then both of these variables can be used in the regression equation, in</p>
<p>order to obtain the model</p>
<p>⎧⎪⎨⎪⎩β0+β1+εi yi = β0+β1xi1+β2xi2+εi = β0+β2+εi</p>
<p>β0+εi</p>
<p>if ith person is from the South if ith person is from the West if ith person is from the East.</p>
<p>(3.30) Now β0 can be interpreted as the average credit card balance for individuals from the East, β1 can be interpreted as the difference in the average balance between people from the South versus the East, and β2 can be interpreted as the difference in the average balance between those from the West versus the East. There will always be one fewer dummy variable than the number of levels. The level with no dummy variable—East in this example—is</p>
<p>known as the baseline.</p>
<p>From Table 3.8, we see that the estimated balance for the baseline, East,</p>
<p>is $531.00. It is estimated that those in the South will have $18.69 less debt than those in the East, and that those in the West will have $12.50 less debt than those in the East. However, the p-values associated with the coefficient estimates for the two dummy variables are very large, suggesting no statistical evidence of a real difference in average credit card balance between South and East or between West and East.11 Once again, the level selected as the baseline category is arbitrary, and the final predictions for each group will be the same regardless of this choice. However, the coefficients and their p-values do depend on the choice of dummy variable coding. Rather than rely on the individual coefficients, we can use an F -test to test H0 : β1 = β2 = 0; this does not depend on the coding. This F-test has a p-value of 0.96, indicating that we cannot reject the null hypothesis that there is no relationship between balance and region.</p>
<p>Using this dummy variable approach presents no difficulties when in- corporating both quantitative and qualitative predictors. For example, to regress balance on both a quantitative variable such as income and a qual- itative variable such as student, we must simply create a dummy variable for student and then fit a multiple regression model using income and the dummy variable as predictors for credit card balance.</p>
<p>There are many different ways of coding qualitative variables besides the dummy variable approach taken here. All of these approaches lead to equivalent model fits, but the coefficients are different and have different interpretations,andaredesignedtomeasureparticularcontrasts.Thistopic is beyond the scope of the book.</p>
<p>3.3.2 Extensions of the Linear Model</p>
<p>The standard linear regression model (3.19) provides interpretable results and works quite well on many real-world problems. However, it makes sev- eral highly restrictive assumptions that are often violated in practice. Two of the most important assumptions state that the relationship between the predictors and response are additive and linear. The additivity assumption means that the association between a predictor Xj and the response Y does not depend on the values of the other predictors. The linearity assumption states that the change in the response Y associated with a one-unit change in Xj is constant, regardless of the value of Xj. In later chapters of this book, we examine a number of sophisticated methods that relax these two assumptions. Here, we briefly examine some common classical approaches for extending the linear model.</p>
<p>Removing the Additive Assumption</p>
<p>In our previous analysis of the Advertising data, we concluded that both TV and radio seem to be associated with sales. The linear models that formed the basis for this conclusion assumed that the effect on sales of increasing one advertising medium is independent of the amount spent on the other media. For example, the linear model (3.20) states that the average increase in sales associated with a one-unit increase in TV is always β1, regardless of the amount spent on radio.</p>
<p>However, this simple model may be incorrect. Suppose that spending money on radio advertising actually increases the effectiveness of TV ad- vertising, so that the slope term for TV should increase as radio increases. In this situation, given a fixed budget of $100,000, spending half on radio and half on TV may increase sales more than allocating the entire amount to either TV or to radio. In marketing, this is known as a synergy effect, and in statistics it is referred to as an interaction effect. Figure 3.5 sug- gests that such an effect may be present in the advertising data. Notice that when levels of either TV or radio are low, then the true sales are lower than predicted by the linear model. But when advertising is split between the two media, then the model tends to underestimate sales.</p>
<p>Consider the standard linear regression model with two variables, Y =β0 +β1X1 +β2X2 +ε.</p>
<p>According to this model, a one-unit increase in X1 is associated with an average increase in Y of β1 units. Notice that the presence of X2 does not alter this statement—that is, regardless of the value of X2, a one- unit increase in X1 is associated with a β1-unit increase in Y . One way of extending this model is to include a third predictor, called an interaction term, which is constructed by computing the product of X1 and X2. This results in the model</p>
<p>Y =β0 +β1X1 +β2X2 +β3X1X2 +ε. (3.31) How does inclusion of this interaction term relax the additive assumption?</p>
<p>Notice that (3.31) can be rewritten as</p>
<p>Y = β0 +(β1 +β3X2)X1 +β2X2 +ε (3.32)</p>
<p>= β0 +β ̃1X1 +β2X2 +ε</p>
<p>where β ̃1 = β1 + β3X2. Since β ̃1 is now a function of X2, the association between X1 and Y is no longer constant: a change in the value of X2 will change the association between X1 and Y . A similar argument shows that a change in the value of X1 changes the association between X2 and Y .</p>
<p>For example, suppose that we are interested in studying the productiv- ity of a factory. We wish to predict the number of units produced on the basis of the number of production lines and the total number of workers. It seems likely that the effect of increasing the number of production lines will depend on the number of workers, since if no workers are available to operate the lines, then increasing the number of lines will not increase production. This suggests that it would be appropriate to include an inter- action term between lines and workers in a linear model to predict units. Suppose that when we fit the model, we obtain</p>
<p>units ≈ 1.2 + 3.4 × lines + 0.22 × workers + 1.4 × (lines × workers) = 1.2 + (3.4 + 1.4 × workers) × lines + 0.22 × workers.</p>
<p>In other words, adding an additional line will increase the number of units produced by 3.4 + 1.4 × workers. Hence the more workers we have, the stronger will be the effect of lines.</p>
<p>We now return to the Advertising example. A linear model that uses radio, TV, and an interaction between the two to predict sales takes the form</p>
<p>sales = β0 + β1 ×TV+ β2 ×radio+ β3 × (radio×TV) + ε</p>
<p>= β0 + (β1 + β3 ×radio) ×TV+ β2 ×radio+ ε. (3.33)</p>
<p>The results in Table 3.9 strongly suggest that the model that includes the interaction term is superior to the model that contains only main effects. The p-value for the interaction term, TV×radio, is extremely low, indicating that there is strong evidence for Ha : β3 ̸= 0. In other words, it is clear that the true relationship is not additive. The R2 for the model (3.33) is 96.8 %, compared to only 89.7 % for the model that predicts sales using TV and radio without an interaction term. This means that (96.8 − 89.7)/(100 − 89.7) = 69 % of the variability in sales that remains after fitting the ad- ditive model has been explained by the interaction term. The coefficient estimates in Table 3.9 suggest that an increase in TV advertising of $1,000 is associated with increased sales of (βˆ1 +βˆ3 ×radio)×1,000 = 19+1.1×radio units. And an increase in radio advertising of $1,000 will be associated with an increase in sales of (βˆ2 + βˆ3 × TV) × 1,000 = 29 + 1.1 × TV units.</p>
<p>In this example, the p-values associated with TV, radio, and the interac- tion term all are statistically significant (Table 3.9), and so it is obvious that all three variables should be included in the model. However, it is sometimes the case that an interaction term has a very small p-value, but the associated main effects (in this case, TV and radio) do not. The hier- archical principle states that if we include an interaction in a model, we should also include the main effects, even if the p-values associated with their coefficients are not significant. In other words, if the interaction be- tween X1 and X2 seems important, then we should include both X1 and X2 in the model even if their coefficient estimates have large p-values. The rationale for this principle is that if X1 × X2 is related to the response, then whether or not the coefficients of X1 or X2 are exactly zero is of lit- tle interest. Also X1 × X2 is typically correlated with X1 and X2, and so leaving them out tends to alter the meaning of the interaction.</p>
<p>In the previous example, we considered an interaction between TV and radio, both of which are quantitative variables. However, the concept of interactions applies just as well to qualitative variables, or to a combination of quantitative and qualitative variables. In fact, an interaction between a qualitative variable and a quantitative variable has a particularly nice interpretation. Consider the Credit data set from Section 3.3.1, and suppose that we wish to predict balance using the income (quantitative) and student (qualitative) variables. In the absence of an interaction term, the model takes the form</p>
<p>balancei</p>
<p>≈ β0 + β1 × incom􏰜ei + 􏰜β2 0 β0 + β2 = β1 ×incomei +</p>
<p>β0</p>
<p>if ith person is a student</p>
<p>if ith person is not a student</p>
<p>if ith person is a student</p>
<p>if ith person is not a student.</p>
<p>Notice that this amounts to fitting two parallel lines to the data, one for students and one for non-students. The lines for students and non-students have different intercepts, β0 + β2 versus β0, but the same slope, β1. This is illustrated in the left-hand panel of Figure 3.7. The fact that the lines are parallel means that the average effect on balance of a one-unit increase in income does not depend on whether or not the individual is a student. This represents a potentially serious limitation of the model, since in fact a change in income may have a very different effect on the credit card balance of a student versus a non-student.</p>
<p>This limitation can be addressed by adding an interaction variable, cre- ated by multiplying income with the dummy variable for student. Our model now becomes</p>
<p>β􏰜 + β × income + 􏰜β2 + β3 × incomei if student balance ≈</p>
<p>i01i</p>
<p>0 if not student</p>
<p>Once again, we have two different regression lines for the students and the non-students. But now those regression lines have different intercepts, β0+β2 versus β0, as well as different slopes, β1+β3 versus β1. This allows for the possibility that changes in income may affect the credit card balances of students and non-students differently. The right-hand panel of Figure 3.7 shows the estimated relationships between income and balance for students and non-students in the model (3.35). We note that the slope for students is lower than the slope for non-students. This suggests that increases in income are associated with smaller increases in credit card balance among students as compared to non-students.</p>
<p>Non-linear Relationships</p>
<p>As discussed previously, the linear regression model (3.19) assumes a linear relationship between the response and predictors. But in some cases, the true relationship between the response and the predictors may be non- linear. Here we present a very simple way to directly extend the linear model to accommodate non-linear relationships, using polynomial regression. In later chapters, we will present more complex approaches for performing non-linear fits in more general settings.</p>
<p>Consider Figure 3.8, in which the mpg (gas mileage in miles per gallon) versus horsepower is shown for a number of cars in the Auto data set. The orange line represents the linear regression fit. There is a pronounced rela- tionship between mpg and horsepower, but it seems clear that this relation- ship is in fact non-linear: the data suggest a curved relationship. A simple approach for incorporating non-linear associations in a linear model is to include transformed versions of the predictors. For example, the points in Figure 3.8 seem to have a quadratic shape, suggesting that a model of the form</p>
<p>mpg = β0 + β1 × horsepower + β2 × horsepower2 + ε (3.36)</p>
<p>may provide a better fit. Equation 3.36 involves predicting mpg using a non-linear function of horsepower. But it is still a linear model! That is, (3.36) is simply a multiple linear regression model with X1 = horsepower and X2 = horsepower2 . So we can use standard linear regression software to estimate β0, β1, and β2 in order to produce a non-linear fit. The blue curve in Figure 3.8 shows the resulting quadratic fit to the data. The quadratic fit appears to be substantially better than the fit obtained when just the linear term is included. The R2 of the quadratic fit is 0.688, compared to 0.606 for the linear fit, and the p-value in Table 3.10 for the quadratic term is highly significant.</p>
<p>If including horsepower2 led to such a big improvement in the model, why not include horsepower3 , horsepower4 , or even horsepower5 ? The green curve in Figure 3.8 displays the fit that results from including all polynomials up to fifth degree in the model (3.36). The resulting fit seems unnecessarily wiggly—that is, it is unclear that including the additional terms really has led to a better fit to the data.</p>
<p>The approach that we have just described for extending the linear model to accommodate non-linear relationships is known as polynomial regres- sion, since we have included polynomial functions of the predictors in the regression model. We further explore this approach and other non-linear extensions of the linear model in Chapter 7.</p>
<p>Potential Problems</p>
<p>When we fit a linear regression model to a particular data set, many prob- lems may occur. Most common among these are the following:</p>
<p>1. Non-linearity of the response-predictor relationships.</p>
<p>2. Correlation of error terms.</p>
<p>3. Non-constant variance of error terms. 4. Outliers.</p>
<p>5. High-leverage points.</p>
<p>6. Collinearity.</p>
<p>In practice, identifying and overcoming these problems is as much an art as a science. Many pages in countless books have been written on this topic. Since the linear regression model is not our primary focus here, we will provide only a brief summary of some key points.</p>
<p>1. Non-linearity of the Data</p>
<p>The linear regression model assumes that there is a straight-line rela- tionship between the predictors and the response. If the true relationship is far from linear, then virtually all of the conclusions that we draw from the fit are suspect. In addition, the prediction accuracy of the model can be significantly reduced.</p>
<p>Residual plots are a useful graphical tool for identifying non-linearity.</p>
<p>residual plot Given a simple linear regression model, we can plot the residuals, ei =</p>
<p>yi − yˆi, versus the predictor xi. In the case of a multiple regression model, since there are multiple predictors, we instead plot the residuals versus</p>
<p>the predicted (or fitted) values yˆi. Ideally, the residual plot will show no fitted discernible pattern. The presence of a pattern may indicate a problem with</p>
<p>some aspect of the linear model.</p>
<p>The left panel of Figure 3.9 displays a residual plot from the linear re- gression of mpg onto horsepower on the Auto data set that was illustrated in Figure 3.8. The red line is a smooth fit to the residuals, which is displayed in order to make it easier to identify any trends. The residuals exhibit a clear U-shape, which provides a strong indication of non-linearity in the data. In contrast, the right-hand panel of Figure 3.9 displays the residual plot that results from the model (3.36), which contains a quadratic term. There appears to be little pattern in the residuals, suggesting that the quadratic term improves the fit to the data.</p>
<p>If the residual plot indicates that there are non-linear associations in the data, then a simple approach is to use non-linear transformations of the predictors, such as logX, √X, and X2, in the regression model. In the later chapters of this book, we will discuss other more advanced non-linear approaches for addressing this issue.</p>
<p>2. Correlation of Error Terms</p>
<p>An important assumption of the linear regression model is that the error terms, ε1,ε2,…,εn, are uncorrelated. What does this mean? For instance, if the errors are uncorrelated, then the fact that εi is positive provides little or no information about the sign of εi+1. The standard errors that are computed for the estimated regression coefficients or the fitted values are based on the assumption of uncorrelated error terms. If in fact there is correlation among the error terms, then the estimated standard errors will tend to underestimate the true standard errors. As a result, confidence and prediction intervals will be narrower than they should be. For example, a 95% confidence interval may in reality have a much lower probability than 0.95 of containing the true value of the parameter. In addition, p- values associated with the model will be lower than they should be; this could cause us to erroneously conclude that a parameter is statistically significant. In short, if the error terms are correlated, we may have an unwarranted sense of confidence in our model.</p>
<p>As an extreme example, suppose we accidentally doubled our data, lead- ing to observations and error terms identical in pairs. If we ignored this, our standard error calculations would be as if we had a sample of size 2n, when in fact we have only n samples. Our estimated parameters would be the same for the 2n samples as for the n samples, but the confidence intervals would be narrower by a factor of √2!</p>
<p>Why might correlations among the error terms occur? Such correlations frequently occur in the context of time series data, which consists of ob- servations for which measurements are obtained at discrete points in time.</p>
<p>In many cases, observations that are obtained at adjacent time points will have positively correlated errors. In order to determine if this is the case for a given data set, we can plot the residuals from our model as a function of time. If the errors are uncorrelated, then there should be no discernible pat- tern. On the other hand, if the error terms are positively correlated, then we may see tracking in the residuals—that is, adjacent residuals may have similar values. Figure 3.10 provides an illustration. In the top panel, we see the residuals from a linear regression fit to data generated with uncorre- lated errors. There is no evidence of a time-related trend in the residuals. In contrast, the residuals in the bottom panel are from a data set in which adjacent errors had a correlation of 0.9. Now there is a clear pattern in the residuals—adjacent residuals tend to take on similar values. Finally, the center panel illustrates a more moderate case in which the residuals had a correlation of 0.5. There is still evidence of tracking, but the pattern is less clear.</p>
<p>Many methods have been developed to properly take account of corre- lations in the error terms in time series data. Correlation among the error terms can also occur outside of time series data. For instance, consider a study in which individuals’ heights are predicted from their weights. The assumption of uncorrelated errors could be violated if some of the indi- viduals in the study are members of the same family, eat the same diet, or have been exposed to the same environmental factors. In general, the assumption of uncorrelated errors is extremely important for linear regres- sion as well as for other statistical methods, and good experimental design is crucial in order to mitigate the risk of such correlations.</p>
<p>3. Non-constant Variance of Error Terms</p>
<p>Another important assumption of the linear regression model is that the error terms have a constant variance, Var(εi) = σ2. The standard errors, confidence intervals, and hypothesis tests associated with the linear model rely upon this assumption.</p>
<p>Unfortunately, it is often the case that the variances of the error terms are non-constant. For instance, the variances of the error terms may increase with the value of the response. One can identify non-constant variances in the errors, or heteroscedasticity, from the presence of a funnel shape in theresidualplot.Anexampleisshownintheleft-handpanelofFigure3.11, in which the magnitude of the residuals tends to increase with the fitted values. When faced with this problem, one possible solution is√to trans- form the response Y using a concave function such as log Y or Y . Such a transformation results in a greater amount of shrinkage of the larger re- sponses, leading to a reduction in heteroscedasticity. The right-hand panel of Figure 3.11 displays the residual plot after transforming the response using log Y . The residuals now appear to have constant variance, though there is some evidence of a slight non-linear relationship in the data.</p>
<p>Sometimes we have a good idea of the variance of each response. For example, the ith response could be an average of ni raw observations. If each of these raw observations is uncorrelated with variance σ2, then their average has variance σi2 = σ2/ni. In this case a simple remedy is to fit our model by weighted least squares, with weights proportional to the inverse variances—i.e.&nbsp;wi = ni in this case. Most linear regression software allows for observation weights.</p>
<p>4. Outliers</p>
<p>Y</p>
<p>−4 −2 0 2 4 6</p>
<p>Residuals</p>
<p>−1 0 1 2 3 4</p>
<p>An outlier is a point for which yi is far from the value predicted by the</p>
<p>outlier model. Outliers can arise for a variety of reasons, such as incorrect recording</p>
<p>of an observation during data collection.</p>
<p>The red point (observation 20) in the left-hand panel of Figure 3.12 illustrates a typical outlier. The red solid line is the least squares regression fit, while the blue dashed line is the least squares fit after removal of the outlier. In this case, removing the outlier has little effect on the least squares line: it leads to almost no change in the slope, and a miniscule reduction in the intercept. It is typical for an outlier that does not have an unusual predictor value to have little effect on the least squares fit. However, even if an outlier does not have much effect on the least squares fit, it can cause other problems. For instance, in this example, the RSE is 1.09 when the outlier is included in the regression, but it is only 0.77 when the outlier is removed. Since the RSE is used to compute all confidence intervals and p-values, such a dramatic increase caused by a single data point can have implications for the interpretation of the fit. Similarly, inclusion of the outlier causes the R2 to decline from 0.892 to 0.805.</p>
<p>Residual plots can be used to identify outliers. In this example, the out- lier is clearly visible in the residual plot illustrated in the center panel of Figure 3.12. But in practice, it can be difficult to decide how large a resid- ual needs to be before we consider the point to be an outlier. To address this problem, instead of plotting the residuals, we can plot the studentized residuals, computed by dividing each residual ei by its estimated standard error. Observations whose studentized residuals are greater than 3 in abso- lute value are possible outliers. In the right-hand panel of Figure 3.12, the outlier’s studentized residual exceeds 6, while all other observations have studentized residuals between −2 and 2.</p>
<p>If we believe that an outlier has occurred due to an error in data collec- tion or recording, then one solution is to simply remove the observation. However, care should be taken, since an outlier may instead indicate a</p>
<p>deficiency with the model, such as a missing predictor.</p>
<p>5. High Leverage Points</p>
<p>studentized residual</p>
<p>We just saw that outliers are observations for which the response yi is unusual given the predictor xi. In contrast, observations with high leverage high have an unusual value for xi. For example, observation 41 in the left-hand</p>
<p>leverage panel of Figure 3.13 has high leverage, in that the predictor value for this observation is large relative to the other observations. (Note that the data displayed in Figure 3.13 are the same as the data displayed in Figure 3.12,</p>
<p>but with the addition of a single high leverage observation.) The red solid line is the least squares fit to the data, while the blue dashed line is the fit produced when observation 41 is removed. Comparing the left-hand panels of Figures 3.12 and 3.13, we observe that removing the high leverage observation has a much more substantial impact on the least squares line than removing the outlier. In fact, high leverage observations tend to have a sizable impact on the estimated regression line. It is cause for concern if the least squares line is heavily affected by just a couple of observations, because any problems with these points may invalidate the entire fit. For this reason, it is important to identify high leverage observations.</p>
<p>In a simple linear regression, high leverage observations are fairly easy to identify, since we can simply look for observations for which the predictor value is outside of the normal range of the observations. But in a multiple linear regression with many predictors, it is possible to have an observation that is well within the range of each individual predictor’s values, but that is unusual in terms of the full set of predictors. An example is shown in the center panel of Figure 3.13, for a data set with two predictors, X1 and X2. Most of the observations’ predictor values fall within the blue dashed ellipse, but the red observation is well outside of this range. But neither its value for X1 nor its value for X2 is unusual. So if we examine just X1 or just X2, we will fail to notice this high leverage point. This problem is more pronounced in multiple regression settings with more than two predictors, because then there is no simple way to plot all dimensions of the data simultaneously.</p>
<p>In order to quantify an observation’s leverage, we compute the leverage statistic. A large value of this statistic indicates an observation with high leverage</p>
<p>statistic</p>
<p>leverage. For a simple linear regression,</p>
<p>1 ( x i − x ̄ ) 2</p>
<p>hi=n+􏰎ni′=1(xi′ −x ̄)2. (3.37)</p>
<p>It is clear from this equation that hi increases with the distance of xi from x ̄. There is a simple extension of hi to the case of multiple predictors, though we do not provide the formula here. The leverage statistic hi is always between 1/n and 1, and the average leverage for all the observations is always equal to (p + 1)/n.&nbsp;So if a given observation has a leverage statistic that greatly exceeds (p+1)/n, then we may suspect that the corresponding point has high leverage.</p>
<p>The right-hand panel of Figure 3.13 provides a plot of the studentized residuals versus hi for the data in the left-hand panel of Figure 3.13. Ob- servation 41 stands out as having a very high leverage statistic as well as a high studentized residual. In other words, it is an outlier as well as a high leverage observation. This is a particularly dangerous combination! This plot also reveals the reason that observation 20 had relatively little effect on the least squares fit in Figure 3.12: it has low leverage.</p>
<p>6. Collinearity</p>
<p>Collinearityreferstothesituationinwhichtwoormorepredictorvariables are closely related to one another. The concept of collinearity is illustrated in Figure 3.14 using the Credit data set. In the left-hand panel of Fig- ure 3.14, the two predictors limit and age appear to have no obvious rela- tionship. In contrast, in the right-hand panel of Figure 3.14, the predictors limit and rating are very highly correlated with each other, and we say that they are collinear. The presence of collinearity can pose problems in the regression context, since it can be difficult to separate out the indi- vidual effects of collinear variables on the response. In other words, since limit and rating tend to increase or decrease together, it can be difficult to determine how each one separately is associated with the response, balance.</p>
<p>Figure 3.15 illustrates some of the difficulties that can result from collinear- ity. The left-hand panel of Figure 3.15 is a contour plot of the RSS (3.22) associated with different possible coefficient estimates for the regression of balance on limit and age. Each ellipse represents a set of coefficients that correspond to the same RSS, with ellipses nearest to the center tak- ing on the lowest values of RSS. The black dots and associated dashed lines represent the coefficient estimates that result in the smallest possible RSS—in other words, these are the least squares estimates. The axes for limit and age have been scaled so that the plot includes possible coeffi- cient estimates that are up to four standard errors on either side of the least squares estimates. Thus the plot includes all plausible values for the coefficients. For example, we see that the true limit coefficient is almost certainly somewhere between 0.15 and 0.20.</p>
<p>In contrast, the right-hand panel of Figure 3.15 displays contour plots of the RSS associated with possible coefficient estimates for the regression of balance onto limit and rating, which we know to be highly collinear. Now the contours run along a narrow valley; there is a broad range of values for the coefficient estimates that result in equal values for RSS. Hence a small change in the data could cause the pair of coefficient values that yield the smallest RSS—that is, the least squares estimates—to move anywhere along this valley. This results in a great deal of uncertainty in the coefficient estimates. Notice that the scale for the limit coefficient now runs from roughly −0.2 to 0.2; this is an eight-fold increase over the plausible range of the limit coefficient in the regression with age. Interestingly, even though the limit and rating coefficients now have much more individual uncertainty, they will almost certainly lie somewhere in this contour valley. For example, we would not expect the true value of the limit and rating coefficients to be −0.1 and 1 respectively, even though such a value is plausible for each coefficient individually.</p>
<p>Since collinearity reduces the accuracy of the estimates of the regression coefficients, it causes the standard error for βˆj to grow. Recall that the t-statistic for each predictor is calculated by dividing βˆj by its standard error. Consequently, collinearity results in a decline in the t-statistic. As a result, in the presence of collinearity, we may fail to reject H0 : βj = 0. This means that the power of the hypothesis test—the probability of correctly detecting a non-zero coefficient—is reduced by collinearity.</p>
<p>Table 3.11 compares the coefficient estimates obtained from two separate multiple regression models. The first is a regression of balance on age and limit, and the second is a regression of balance on rating and limit. In the first regression, both age and limit are highly significant with very small p- values. In the second, the collinearity between limit and rating has caused the standard error for the limit coefficient estimate to increase by a factor of 12 and the p-value to increase to 0.701. In other words, the importance of the limit variable has been masked due to the presence of collinearity.</p>
<p>To avoid such a situation, it is desirable to identify and address potential collinearity problems while fitting the model.</p>
<p>A simple way to detect collinearity is to look at the correlation matrix of the predictors. An element of this matrix that is large in absolute value indicates a pair of highly correlated variables, and therefore a collinearity problem in the data. Unfortunately, not all collinearity problems can be detected by inspection of the correlation matrix: it is possible for collinear- ity to exist between three or more variables even if no pair of variables has a particularly high correlation. We call this situation multicollinearity. Instead of inspecting the correlation matrix, a better way to assess multi- collinearity is to compute the variance inflation factor (VIF). The VIF is the ratio of the variance of βˆj when fitting the full model divided by the variance of βˆj if fit on its own. The smallest possible value for VIF is 1, which indicates the complete absence of collinearity. Typically in practice there is a small amount of collinearity among the predictors. As a rule of thumb, a VIF value that exceeds 5 or 10 indicates a problematic amount of collinearity. The VIF for each variable can be computed using the formula</p>
<p>multi- collinearity</p>
<p>variance inflation factor</p>
<p>VIF(βˆj) = 1 , 1−R2</p>
<p>Xj |X−j</p>
<p>where R2 is the R2 from a regression of Xj onto all of the other</p>
<p>Xj|X−j 2</p>
<p>predictors. If RXj|X−j is close to one, then collinearity is present, and so</p>
<p>the VIF will be large.</p>
<p>In the Credit data, a regression of balance on age, rating, and limit</p>
<p>indicates that the predictors have VIF values of 1.01, 160.67, and 160.59. As we suspected, there is considerable collinearity in the data!</p>
<p>When faced with the problem of collinearity, there are two simple solu- tions. The first is to drop one of the problematic variables from the regres- sion. This can usually be done without much compromise to the regression fit, since the presence of collinearity implies that the information that this variable provides about the response is redundant in the presence of the other variables. For instance, if we regress balance onto age and limit, without the rating predictor, then the resulting VIF values are close to the minimum possible value of 1, and the R2 drops from 0.754 to 0.75. So dropping rating from the set of predictors has effectively solved the collinearity problem without compromising the fit. The second solution is to combine the collinear variables together into a single predictor. For in- stance, we might take the average of standardized versions of limit and rating in order to create a new variable that measures credit worthiness.</p>
<p>## Marketing Questions</p>
<p>## Comparison of Linear Regression with K-Nearest Neighbors</p>
<p>3.5 Comparison of Linear Regression with K-Nearest Neighbors 105</p>
<p>As discussed in Chapter 2, linear regression is an example of a parametric approach because it assumes a linear functional form for f(X). Parametric methods have several advantages. They are often easy to fit, because one need estimate only a small number of coefficients. In the case of linear re- gression, the coefficients have simple interpretations, and tests of statistical significance can be easily performed. But parametric methods do have a disadvantage: by construction, they make strong assumptions about the form of f(X). If the specified functional form is far from the truth, and prediction accuracy is our goal, then the parametric method will perform poorly. For instance, if we assume a linear relationship between X and Y but the true relationship is far from linear, then the resulting model will provide a poor fit to the data, and any conclusions drawn from it will be suspect.</p>
<p>In contrast, non-parametric methods do not explicitly assume a para- metric form for f(X), and thereby provide an alternative and more flexi- ble approach for performing regression. We discuss various non-parametric methods in this book. Here we consider one of the simplest and best-known non-parametricmethods,K-nearestneighborsregression(KNNregression). The KNN regression method is closely related to the KNN classifier dis- cussed in Chapter 2. Given a value for K and a prediction point x0, KNN regression first identifies the K training observations that are closest to x0, represented by N0. It then estimates f(x0) using the average of all the training responses in N0. In other words􏰓,</p>
<p>K-nearest neighbors regression</p>
<p>1</p>
<p>f(x0) = K yi.</p>
<p>xi ∈N0</p>
<p>Figure 3.16 illustrates two KNN fits on a data set with p = 2 predictors. The fit with K = 1 is shown in the left-hand panel, while the right-hand panel corresponds to K = 9. We see that when K = 1, the KNN fit perfectly interpolates the training observations, and consequently takes the form of a step function. When K = 9, the KNN fit still is a step function, but averaging over nine observations results in much smaller regions of constant prediction, and consequently a smoother fit. In general, the optimal value for K will depend on the bias-variance tradeoff, which we introduced in Chapter 2. A small value for K provides the most flexible fit, which will have low bias but high variance. This variance is due to the fact that the prediction in a given region is entirely dependent on just one observation. In contrast, larger values of K provide a smoother and less variable fit; the prediction in a region is an average of several points, and so changing one observation has a smaller effect. However, the smoothing may cause bias by masking some of the structure in f(X). In Chapter 5, we introduce several approaches for estimating test error rates. These methods can be used to identify the optimal value of K in KNN regression.</p>
<p>In what setting will a parametric approach such as least squares linear re- gression outperform a non-parametric approach such as KNN regression? The answer is simple: the parametric approach will outperform the non- parametric approach if the parametric form that has been selected is close to the true form of f.&nbsp;Figure 3.17 provides an example with data generated from a one-dimensional linear regression model. The black solid lines rep- resent f(X), while the blue curves correspond to the KNN fits using K = 1 and K = 9. In this case, the K = 1 predictions are far too variable, while the smoother K = 9 fit is much closer to f(X). However, since the true relationship is linear, it is hard for a non-parametric approach to compete with linear regression: a non-parametric approach incurs a cost in variance that is not offset by a reduction in bias. The blue dashed line in the left- hand panel of Figure 3.18 represents the linear regression fit to the same data. It is almost perfect. The right-hand panel of Figure 3.18 reveals that linear regression outperforms KNN for this data. The green solid line, plotted as a function of 1/K, represents the test set mean squared error (MSE) for KNN. The KNN errors are well above the black dashed line, which is the test MSE for linear regression. When the value of K is large, then KNN performs only a little worse than least squares regression in terms of MSE. It performs far worse when K is small.</p>
<p>In practice, the true relationship between X and Y is rarely exactly lin- ear. Figure 3.19 examines the relative performances of least squares regres- sion and KNN under increasing levels of non-linearity in the relationship between X and Y . In the top row, the true relationship is nearly linear. In this case we see that the test MSE for linear regression is still superior to that of KNN for low values of K. However, for K ≥ 4, KNN out- performs linear regression. The second row illustrates a more substantial deviation from linearity. In this situation, KNN substantially outperforms linear regression for all values of K. Note that as the extent of non-linearity increases, there is little change in the test set MSE for the non-parametric KNN method, but there is a large increase in the test set MSE of linear regression.</p>
<p>Figures 3.18 and 3.19 display situations in which KNN performs slightly worse than linear regression when the relationship is linear, but much bet- ter than linear regression for non-linear situations. In a real life situation in which the true relationship is unknown, one might suspect that KNN should be favored over linear regression because it will at worst be slightly inferior to linear regression if the true relationship is linear, and may give substantially better results if the true relationship is non-linear. But in re- ality, even when the true relationship is highly non-linear, KNN may still provide inferior results to linear regression. In particular, both Figures 3.18 and 3.19 illustrate settings with p = 1 predictor. But in higher dimensions, KNN often performs worse than linear regression.</p>
<p>Figure 3.20 considers the same strongly non-linear situation as in the</p>
<p>second row of Figure 3.19, except that we have added additional noise</p>
<p>predictors that are not associated with the response. When p = 1 or p = 2,</p>
<p>KNN outperforms linear regression. But for p = 3 the results are mixed,</p>
<p>and for p ≥ 4 linear regression is superior to KNN. In fact, the increase in</p>
<p>dimension has only caused a small deterioration in the linear regression test</p>
<p>set MSE, but it has caused more than a ten-fold increase in the MSE for</p>
<p>KNN. This decrease in performance as the dimension increases is a common</p>
<p>problem for KNN, and results from the fact that in higher dimensions</p>
<p>there is effectively a reduction in sample size. In this data set there are</p>
<p>50 training observations; when p = 1, this provides enough information to</p>
<p>accurately estimate f(X). However, spreading 50 observations over p = 20</p>
<p>dimensions results in a phenomenon in which a given observation has no</p>
<p>nearby neighbors—this is the so-called curse of dimensionality. That is,</p>
<p>the K observations that are nearest to a given test observation x0 may be mensionality very far away from x0 in p-dimensional space when p is large, leading to a</p>
<p>very poor prediction of f(x0) and hence a poor KNN fit. As a general rule, parametric methods will tend to outperform non-parametric approaches when there is a small number of observations per predictor.</p>
<p>Even when the dimension is small, we might prefer linear regression to KNN from an interpretability standpoint. If the test MSE of KNN is only slightly lower than that of linear regression, we might be willing to forego a little bit of prediction accuracy for the sake of a simple model that can be described in terms of just a few coefficients, and for which p-values are available.</p>
<p>## Lab: Linear Regression</p>
<p>```{r}</p>
<p>library(“MASS”)</p>
<p>library(“ISLR2”)</p>
<p>```</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>